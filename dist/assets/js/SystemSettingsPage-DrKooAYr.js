function e(){const[e,d]=i.useState({general:{organizationName:"Dernek Yönetim Sistemi",organizationAddress:"",organizationPhone:"",organizationEmail:""},notifications:{emailNotifications:!0,smsNotifications:!1,pushNotifications:!0,auditLogNotifications:!0},security:{sessionTimeout:30,passwordExpiry:90,mfaEnabled:!1,ipWhitelist:[]},database:{backupFrequency:"daily",dataRetentionDays:365,enableArchiving:!0}}),[o,h]=i.useState(!0),[m,j]=i.useState(!1),[E,z]=i.useState(null),B=async()=>{h(!0),z(null);try{const e=await A.getSettings();e.error?(e.error.includes("tablosu bulunamadı")?z(e.error):S.error(e.error),c.error("Error loading settings",e.error)):e.data&&d(e.data)}catch(e){S.error("Ayarlar yüklenirken beklenmeyen bir hata oluştu"),c.error("Unexpected error loading settings",e)}finally{h(!1)}};i.useEffect(()=>{B()},[]);const D=(e,i)=>{d(a=>({...a,general:{...a.general,[e]:i}}))},T=(e,i)=>{d(a=>({...a,notifications:{...a.notifications,[e]:i}}))},X=(e,i)=>{d(a=>({...a,security:{...a.security,[e]:i}}))},P=(e,i)=>{d(a=>({...a,database:{...a.database,[e]:i}}))};return o?a.jsx(u,{}):a.jsx(g,{title:"Sistem Ayarları",subtitle:"Sistem genelinde uygulanacak ayarları yapılandırın",actions:a.jsxs(v,{onClick:async()=>{j(!0);try{const i=await A.updateSettings(e);if(i.error)return i.error.includes("tablosu bulunamadı")?z(i.error):S.error(i.error),void 0;S.success("Ayarlar başarıyla kaydedildi"),await B()}catch(i){S.error("Ayarlar kaydedilirken beklenmeyen bir hata oluştu"),c.error("Settings save error:",i)}finally{j(!1)}},disabled:m,children:[a.jsx(l,{className:"w-4 h-4 mr-2"}),m?"Kaydediliyor...":"Kaydet"]}),children:a.jsxs("div",{className:"p-6",children:[E&&a.jsx(C,{className:"mb-6",children:a.jsxs(F,{children:[E," Lütfen veritabanı migrasyonunu çalıştırın."]})}),a.jsxs(N,{defaultValue:"general",className:"w-full",children:[a.jsxs(k,{className:"grid w-full grid-cols-4 mb-6",children:[a.jsxs(x,{value:"general",children:[a.jsx(t,{className:"w-4 h-4 mr-2"}),"Genel"]}),a.jsxs(x,{value:"notifications",children:[a.jsx(r,{className:"w-4 h-4 mr-2"}),"Bildirimler"]}),a.jsxs(x,{value:"security",children:[a.jsx(n,{className:"w-4 h-4 mr-2"}),"Güvenlik"]}),a.jsxs(x,{value:"database",children:[a.jsx(s,{className:"w-4 h-4 mr-2"}),"Veritabanı"]})]}),a.jsx(w,{value:"general",children:a.jsx(y,{className:"p-6",children:a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Kurum Bilgileri"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx(p,{htmlFor:"orgName",children:"Kurum Adı"}),a.jsx(f,{id:"orgName",value:e.general.organizationName,onChange:e=>{D("organizationName",e.target.value)},placeholder:"Dernek adını giriniz"})]}),a.jsxs("div",{children:[a.jsx(p,{htmlFor:"orgEmail",children:"E-posta"}),a.jsx(f,{id:"orgEmail",type:"email",value:e.general.organizationEmail,onChange:e=>{D("organizationEmail",e.target.value)},placeholder:"info@dernek.org"})]}),a.jsxs("div",{children:[a.jsx(p,{htmlFor:"orgPhone",children:"Telefon"}),a.jsx(f,{id:"orgPhone",value:e.general.organizationPhone,onChange:e=>{D("organizationPhone",e.target.value)},placeholder:"+90 XXX XXX XX XX"})]}),a.jsxs("div",{children:[a.jsx(p,{htmlFor:"orgAddress",children:"Adres"}),a.jsx(f,{id:"orgAddress",value:e.general.organizationAddress,onChange:e=>{D("organizationAddress",e.target.value)},placeholder:"Kurum adresi"})]})]})]})})})}),a.jsx(w,{value:"notifications",children:a.jsx(y,{className:"p-6",children:a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Bildirim Tercihleri"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(p,{htmlFor:"emailNotif",children:"E-posta Bildirimleri"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Önemli olaylar için e-posta gönderin"})]}),a.jsx(b,{id:"emailNotif",checked:e.notifications.emailNotifications,onCheckedChange:e=>{T("emailNotifications",e)}})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(p,{htmlFor:"smsNotif",children:"SMS Bildirimleri"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Kritik işlemler için SMS gönderin"})]}),a.jsx(b,{id:"smsNotif",checked:e.notifications.smsNotifications,onCheckedChange:e=>{T("smsNotifications",e)}})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(p,{htmlFor:"pushNotif",children:"Push Bildirimleri"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Tarayıcı push bildirimleri"})]}),a.jsx(b,{id:"pushNotif",checked:e.notifications.pushNotifications,onCheckedChange:e=>{T("pushNotifications",e)}})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(p,{htmlFor:"auditNotif",children:"Audit Log Bildirimleri"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Güvenlik olayları için bildirim"})]}),a.jsx(b,{id:"auditNotif",checked:e.notifications.auditLogNotifications,onCheckedChange:e=>{T("auditLogNotifications",e)}})]})]})]})})})}),a.jsx(w,{value:"security",children:a.jsx(y,{className:"p-6",children:a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Güvenlik Ayarları"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(p,{htmlFor:"mfa",children:"İki Faktörlü Doğrulama (2FA)"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Tüm kullanıcılar için 2FA zorunluluğu"})]}),a.jsx(b,{id:"mfa",checked:e.security.mfaEnabled,onCheckedChange:e=>{X("mfaEnabled",e)}})]}),a.jsxs("div",{children:[a.jsx(p,{htmlFor:"sessionTimeout",children:"Oturum Zaman Aşımı (dakika)"}),a.jsx(f,{id:"sessionTimeout",type:"number",value:e.security.sessionTimeout,onChange:e=>{X("sessionTimeout",parseInt(e.target.value))},placeholder:"30"})]}),a.jsxs("div",{children:[a.jsx(p,{htmlFor:"passwordExpiry",children:"Şifre Geçerlilik Süresi (gün)"}),a.jsx(f,{id:"passwordExpiry",type:"number",value:e.security.passwordExpiry,onChange:e=>{X("passwordExpiry",parseInt(e.target.value))},placeholder:"90"})]}),a.jsxs("div",{children:[a.jsx(p,{htmlFor:"ipWhitelist",children:"IP Whitelist"}),a.jsx(f,{id:"ipWhitelist",value:e.security.ipWhitelist,onChange:e=>{X("ipWhitelist",e.target.value)},placeholder:"192.168.1.1, 10.0.0.1"}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Virgülle ayrılmış IP adresleri"})]})]})]})})})}),a.jsx(w,{value:"database",children:a.jsx(y,{className:"p-6",children:a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Veritabanı Yönetimi"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(p,{htmlFor:"backupFreq",children:"Yedekleme Sıklığı"}),a.jsxs("select",{id:"backupFreq",className:"w-full px-3 py-2 border border-gray-300 rounded-lg",value:e.database.backupFrequency,onChange:e=>{P("backupFrequency",e.target.value)},children:[a.jsx("option",{value:"hourly",children:"Saatlik"}),a.jsx("option",{value:"daily",children:"Günlük"}),a.jsx("option",{value:"weekly",children:"Haftalık"}),a.jsx("option",{value:"monthly",children:"Aylık"})]})]}),a.jsxs("div",{children:[a.jsx(p,{htmlFor:"retention",children:"Veri Saklama Süresi (gün)"}),a.jsx(f,{id:"retention",type:"number",value:e.database.dataRetentionDays,onChange:e=>{P("dataRetentionDays",parseInt(e.target.value))},placeholder:"365"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(p,{htmlFor:"archiving",children:"Otomatik Arşivleme"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Eski kayıtları otomatik arşivle"})]}),a.jsx(b,{id:"archiving",checked:e.database.enableArchiving,onCheckedChange:e=>{P("enableArchiving",e)}})]})]})]})})})})]})]})})}import{r as i,j as a,bC as t,ae as r,bH as n,c3 as s,c4 as l}from"./react-vendor-Zi_jsHoK.js";import{i as d,l as c,h as o,w as h,u as m,L as u,Y as g,C as y,t as p,I as f,B as v}from"./beneficiaries-page-CkZlrYV8.js";import{S as b}from"./switch-C3esbnVh.js";import{T as N,a as k,b as x,c as w}from"./tabs-fYszpb1R.js";import{t as S}from"./toast-vendor-Ci27VDWJ.js";import{A as C,f as F}from"./user-management-page-B6-AaFFc.js";import"./ui-vendor-f6_gbUtQ.js";import"./utils-vendor-CH-VcvGo.js";import"./appwrite-vendor-Ct7vfU_L.js";import"./motion-vendor-iBxafAnt.js";import"./messaging-page-BEU6nUaR.js";import"./events-finance-page-DWyC3OLf.js";const A=new class{collectionName=d.SYSTEM_SETTINGS;getDefaultSettings(){return{general:{organizationName:"Dernek Yönetim Sistemi",organizationAddress:"",organizationPhone:"",organizationEmail:""},notifications:{emailNotifications:!0,smsNotifications:!1,pushNotifications:!0,auditLogNotifications:!0},security:{sessionTimeout:30,passwordExpiry:90,mfaEnabled:!1,ipWhitelist:[]},database:{backupFrequency:"daily",dataRetentionDays:365,enableArchiving:!0}}}async getSettings(){try{c.info("Fetching system settings");const{data:e,error:i}=await o.list(this.collectionName,[h.limit(1)]);if(i)return c.error("Error fetching system settings",i),{data:this.getDefaultSettings(),error:"Sistem ayarları yüklenirken bir hata oluştu"};const a=e?.documents?.[0];if(!a)return c.info("No system settings found, returning defaults"),{data:this.getDefaultSettings(),error:null};const t=this.getDefaultSettings(),r={general:{...t.general,...a.general||{}},notifications:{...t.notifications,...a.notifications||{}},security:{...t.security,...a.security||{}},database:{...t.database,...a.database||{}}};return c.info("Successfully fetched system settings"),{data:r,error:null}}catch(e){return c.error("Unexpected error fetching system settings",e),{data:this.getDefaultSettings(),error:"Beklenmeyen bir hata oluştu"}}}async updateSettings(e){try{c.info("Updating system settings");const i=m.getState().user,a={general:e.general,notifications:e.notifications,security:e.security,database:e.database,updated_at:(new Date).toISOString(),updated_by:i?.id||null},{data:t}=await o.list(this.collectionName,[h.limit(1)]);let r;return r=t?.documents?.[0]?await o.update(this.collectionName,t.documents[0].$id,a):await o.create(this.collectionName,{...a,id:1},"system-settings-1"),r.error?(c.error("Error updating system settings",r.error),{data:null,error:"Sistem ayarları güncellenirken bir hata oluştu"}):(c.info("Successfully updated system settings"),{data:!0,error:null})}catch(i){return c.error("Unexpected error updating system settings",i),{data:null,error:"Beklenmeyen bir hata oluştu"}}}async resetSettings(){try{c.info("Resetting system settings to defaults");const e=this.getDefaultSettings(),i=await this.updateSettings(e);return i.error?i:(c.info("Successfully reset system settings"),{data:!0,error:null})}catch(e){return c.error("Unexpected error resetting system settings",e),{data:null,error:"Beklenmeyen bir hata oluştu"}}}getDefaultSettingsPublic(){return this.getDefaultSettings()}};export{e as SystemSettingsPage,e as default};
