function e(){const[e,u]=a.useState(!0),[g,I]=a.useState(!1),[P,Q]=a.useState(""),[W,ae]=a.useState("all"),[re,te]=a.useState("all"),[ne,ie]=a.useState("all"),[le,se]=a.useState([]),[oe,de]=a.useState(1),[ce]=a.useState(10),[me,he]=a.useState(!1),[pe,ue]=a.useState({total:0,totalAmount:0,pending:0,approved:0,rejected:0,averageAmount:0}),ge=function({schema:e,initialValues:r,onSubmit:t,validateOnChange:n=!0,validateOnBlur:i=!0}){const[l,s]=a.useState(r),[o,d]=a.useState({}),[c,m]=a.useState({}),[h,u]=a.useState(!1),[g,x]=a.useState(0),y=Object.keys(e).every(a=>{const r=e[a],t=l[a];return!(r.required&&(!t||"string"==typeof t&&""===t.trim())||o[a])}),v=a.useCallback((e,a)=>{s(r=>({...r,[e]:a})),o[e]&&d(a=>({...a,[e]:""})),n&&k(e,a)},[o,n]),f=a.useCallback(e=>{s(a=>({...a,...e}))},[]),b=a.useCallback((e,a)=>{d(r=>({...r,[e]:a}))},[]),N=a.useCallback((e,a=!0)=>{m(r=>({...r,[e]:a}))},[]),w=a.useCallback((e,a)=>{d(r=>({...r,[e]:a??""}))},[]),k=a.useCallback((a,r)=>{const t=e[a];if(!t)return!0;let n=r;if(t.sanitize&&"string"==typeof r&&(n=t.sanitize(r)),t.required){const e=U(n,a);if(!e.isValid)return b(a,e.error),!1}if(!n&&!t.required)return w(a),!0;if(t.minLength&&"string"==typeof n){const e=Z(n,t.minLength,a);if(!e.isValid)return b(a,e.error),!1}if(t.maxLength&&"string"==typeof n){const e=J(n,t.maxLength,a);if(!e.isValid)return b(a,e.error),!1}if(t.pattern&&"string"==typeof n&&!t.pattern.test(n))return b(a,`${a} formatı geçersiz`),!1;if(t.custom){const e=t.custom(n);if(!e.isValid)return b(a,e.error),!1}return w(a),!0},[e,b,w]),_=a.useCallback(e=>k(e,l[e]),[k,l]),B=a.useCallback(()=>{const a=((e,a)=>{const r=[];for(const[t,n]of Object.entries(a)){const a=e[t];let i=a;if(n.sanitize&&"string"==typeof a&&(i=n.sanitize(a)),n.required){const e=U("boolean"==typeof i?i.toString():i,t);if(!e.isValid){r.push(e.error);continue}}if(i||n.required){if(n.minLength&&"string"==typeof i){const e=Z(i,n.minLength,t);e.isValid||r.push(e.error)}if(n.maxLength&&"string"==typeof i){const e=J(i,n.maxLength,t);e.isValid||r.push(e.error)}if(n.pattern&&"string"==typeof i&&(n.pattern.test(i)||r.push(`${t} formatı geçersiz`)),n.custom){const e=n.custom(i);e.isValid||r.push(e.error)}}}return{isValid:0===r.length,errors:r}})(l,e),r={};return a.errors.forEach((a,t)=>{const n=Object.keys(e)[t];r[n]=a}),d(r),a},[l,e]),T=a.useCallback(()=>{s(r),d({}),m({}),u(!1),x(0)},[r]),C=a.useCallback(async a=>{a&&a.preventDefault(),u(!0),x(e=>e+1);const r={};if(Object.keys(e).forEach(e=>{r[e]=!0}),m(r),!B().isValid)return u(!1),void 0;try{const a={};Object.keys(l).forEach(r=>{const t=r,n=l[t],i=e[t];a[t]=i?.sanitize&&"string"==typeof n?i.sanitize(n):n}),t&&await t(a)}catch(n){p.error("Form submission error:",n)}finally{u(!1)}},[B,t,l,e]),j=a.useCallback(e=>{N(e,!0),i&&k(e,l[e])},[N,i,k,l]),V=a.useCallback((e,a)=>{v(e,a)},[v]);return{values:l,errors:o,touched:c,isValid:y,isSubmitting:h,submitCount:g,setValue:v,setValues:f,setError:b,setTouched:N,setFieldError:w,validateField:_,validateForm:B,reset:T,handleSubmit:C,handleBlur:j,handleChange:V}}({schema:X.donation,initialValues:{donor_name:"",donor_email:"",donor_phone:"",amount:0,donation_type:"cash",category:"",description:"",payment_method:"bank_transfer"},onSubmit:async e=>{await fe(e)}}),xe=a.useCallback(async()=>{try{u(!0);const e={...P.trim()&&{searchTerm:P.trim()},..."all"!==W&&{status:W},..."all"!==re&&{donationType:re},..."all"!==ne&&{paymentMethod:ne}},a=await ee.getDonations(oe,ce,e);if(a.error)return p.error("❌ Error loading donations:",a.error),se([]),G.error("Bağışlar yüklenirken hata oluştu"),void 0;a.data&&Array.isArray(a.data)?se(a.data):se([])}catch(e){p.error("Error loading donations:",e),se([]),G.error("Bağışlar yüklenirken hata oluştu")}finally{u(!1)}},[oe,ce,P,W,re,ne]),ye=a.useCallback(async()=>{try{const e=await ee.getDonationStats();e.data&&ue({total:e.data.total,totalAmount:e.data.totalAmount,pending:e.data.pending,approved:e.data.approved,rejected:e.data.rejected,averageAmount:e.data.averageAmount})}catch(e){p.error("Error loading donation stats:",e)}},[]);a.useEffect(()=>{xe(),ye()},[xe,ye]),a.useEffect(()=>{const e=setTimeout(()=>{de(1),xe()},300);return()=>{clearTimeout(e)}},[P,W,re,ne,xe]);const ve=e=>{const a={approved:"success",rejected:"error",pending:"pending",processing:"info",completed:"success"}[e]||"pending",t={approved:"Onaylandı",rejected:"Reddedildi",pending:"Beklemede",processing:"İşleniyor",completed:"Tamamlandı"}[e]||e;return r.jsx(H,{status:a,children:t})},fe=async e=>{const a=e??ge.values;try{I(!0);const e=await ee.createDonation({donor_name:a.donor_name.trim(),donor_email:a.donor_email?.trim()??void 0,donor_phone:a.donor_phone?.trim()??void 0,amount:a.amount,donation_type:a.donation_type,category:a.category?.trim()??void 0,description:a.description?.trim()??void 0,payment_method:a.payment_method,status:"pending"});if(e.error)throw new Error(e.error);G.success("Bağış başarıyla kaydedildi!"),ge.reset(),he(!1),await xe(),await ye()}catch(r){p.error("Error creating donation:",r),G.error(r instanceof Error?r.message:"Bağış kaydedilemedi")}finally{I(!1)}},be=async(e,a)=>{try{const r=await ee.updateDonation(e,{status:a});if(r.error)throw new Error(r.error);G.success("Bağış durumu güncellendi"),await xe(),await ye()}catch(r){p.error("Error updating donation status:",r),G.error("Durum güncellenemedi")}},Ne=async e=>{if(confirm("Bu bağışı silmek istediğinizden emin misiniz?"))try{const a=await ee.deleteDonation(e);if(a.error)throw new Error(a.error);G.success("Bağış silindi"),await xe(),await ye()}catch(a){p.error("Error deleting donation:",a),G.error("Bağış silinemedi")}},we=[{key:"donor_name",title:"Bağışçı",mobileLabel:"Bağışçı",render:(e,a)=>r.jsxs("div",{children:[r.jsx("div",{className:"font-medium",children:a.donor_name}),a.donor_email&&r.jsx("div",{className:"text-sm text-neutral-500",children:a.donor_email})]})},{key:"amount",title:"Tutar",mobileLabel:"Tutar",render:e=>r.jsxs("span",{className:"font-semibold text-green-600",children:["₺",e.toLocaleString()]})},{key:"created_at",title:"Tarih",mobileLabel:"Tarih",render:e=>r.jsx("span",{className:"text-neutral-500",children:D(e)})},{key:"status",title:"Durum",mobileLabel:"Durum",render:e=>ve(e)},{key:"payment_method",title:"Yöntem",mobileLabel:"Ödeme",hideOnMobile:!0,render:e=>r.jsx("span",{className:"text-gray-600",children:e})},{key:"donation_type",title:"Tür",mobileLabel:"Tür",hideOnMobile:!0,render:e=>r.jsx("span",{className:"text-gray-600",children:e})},{key:"actions",title:"İşlemler",mobileLabel:"İşlemler",hideOnMobile:!0,render:(e,a)=>{const t=q.view,n=q.delete;return r.jsxs("div",{className:"flex items-center justify-center gap-2",children:["pending"===a.status&&r.jsxs(r.Fragment,{children:[r.jsxs(S,{children:[r.jsx(M,{asChild:!0,children:r.jsx(z,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-green-600 hover:bg-green-50 hover:text-green-700",onClick:e=>{e.stopPropagation(),be(a.id,"approved")},"aria-label":`Approve donation from ${a.donor_name}`,children:r.jsx(l,{className:"h-4 w-4"})})}),r.jsx(R,{children:"Onayla"})]}),r.jsxs(S,{children:[r.jsx(M,{asChild:!0,children:r.jsx(z,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-600 hover:bg-red-50 hover:text-red-700",onClick:e=>{e.stopPropagation(),be(a.id,"rejected")},"aria-label":`Reject donation from ${a.donor_name}`,children:r.jsx(m,{className:"h-4 w-4"})})}),r.jsx(R,{children:"Reddet"})]})]}),r.jsxs(S,{children:[r.jsx(M,{asChild:!0,children:r.jsx(z,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-blue-600 hover:bg-blue-50 hover:text-blue-700","aria-label":`View donation from ${a.donor_name}`,children:r.jsx(t,{className:"h-4 w-4"})})}),r.jsx(R,{children:"Detayları Görüntüle"})]}),r.jsxs(S,{children:[r.jsx(M,{asChild:!0,children:r.jsx(z,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-600 hover:bg-red-50 hover:text-red-700",onClick:e=>{e.stopPropagation(),Ne(a.id)},"aria-label":`Delete donation from ${a.donor_name}`,children:r.jsx(n,{className:"h-4 w-4"})})}),r.jsx(R,{children:"Sil"})]})]})}}];return e&&0===le.length?r.jsx(x,{}):r.jsx(y,{title:"Bağış Yönetimi",subtitle:"Tüm bağışları görüntüleyin ve yönetin",actions:r.jsxs("div",{className:"flex w-full flex-wrap items-center justify-end gap-2 p-2 sm:w-auto sm:p-0",children:[r.jsxs(z,{variant:"outline",size:"sm",className:"order-2 min-h-[44px] min-w-[44px] border-neutral-300 px-3 text-sm hover:border-neutral-400 sm:order-1 sm:px-4",onClick:async()=>{try{const e={...P.trim()&&{searchTerm:P.trim()},..."all"!==W&&{status:W},..."all"!==re&&{donationType:re},..."all"!==ne&&{paymentMethod:ne}},a=await ee.exportDonations(e);if(a.data){const e=[["Bağışçı","E-posta","Telefon","Miktar","Tür","Ödeme Yöntemi","Durum","Tarih"],...a.data.map(e=>[e.donor_name,e.donor_email??"",e.donor_phone??"",e.amount,e.donation_type,e.payment_method,e.status,D(e.created_at)])].map(e=>e.join(",")).join("\n"),r=new Blob([`\ufeff${e}`],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a");t.href=URL.createObjectURL(r),t.download=`bagislar_${(new Date).toISOString().split("T")[0]}.csv`,t.click(),G.success("Bağışlar Excel formatında dışa aktarıldı")}else G.error("Dışa aktarma başarısız")}catch(e){p.error("Export error:",e),G.error("Dışa aktarma sırasında hata oluştu")}},children:[r.jsx(o,{className:"mr-1 h-4 w-4 sm:mr-2"}),r.jsx("span",{className:"hidden sm:inline",children:"Dışa Aktar"}),r.jsx("span",{className:"sm:hidden",children:"Dışa Aktar"})]}),r.jsxs($,{open:me,onOpenChange:he,children:[r.jsx(E,{asChild:!0,children:r.jsxs(z,{variant:"default",size:"sm",className:"order-1 min-h-[44px] min-w-[44px] flex-shrink-0 border-none px-3 py-3 text-white shadow-lg transition-all duration-300 hover:shadow-xl sm:order-2 sm:px-6 corporate-gradient",children:[r.jsx(d,{className:"mr-1 h-4 w-4 sm:mr-2"}),r.jsx("span",{className:"hidden sm:inline",children:"Yeni Bağış"}),r.jsx("span",{className:"sm:hidden",children:"Yeni Bağış"})]})}),r.jsxs(L,{className:"professional-card max-h-[90vh] max-w-[95vw] overflow-y-auto sm:max-w-lg",children:[r.jsxs(O,{className:"pb-4",children:[r.jsxs(A,{className:"flex items-center gap-2",children:[r.jsx(d,{className:"text-primary h-6 w-6"}),"Yeni Bağış Kaydı"]}),r.jsx(F,{className:"text-muted-foreground mt-1",children:"Bağış bilgilerini doldurun. Zorunlu alanları (*) doldurmanız gereklidir."})]}),r.jsxs("form",{onSubmit:ge.handleSubmit,className:"space-y-4 py-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"donor_name",children:"Bağışçı Adı *"}),r.jsx(w,{id:"donor_name",value:ge.values.donor_name,onChange:e=>{ge.handleChange("donor_name",e.target.value)},onBlur:()=>{ge.handleBlur("donor_name")},placeholder:"Bağışçının tam adını giriniz",className:"focus-corporate min-h-[44px] "+(ge.touched.donor_name&&ge.errors.donor_name?"border-red-500 focus:border-red-500":""),disabled:g}),ge.touched.donor_name&&ge.errors.donor_name&&r.jsx("p",{className:"text-sm text-red-600",children:ge.errors.donor_name})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"donor_email",children:"E-posta"}),r.jsx(w,{id:"donor_email",type:"email",value:ge.values.donor_email,onChange:e=>{ge.handleChange("donor_email",e.target.value)},onBlur:()=>{ge.handleBlur("donor_email")},placeholder:"bağışçı@email.com",className:"focus-corporate min-h-[44px] "+(ge.touched.donor_email&&ge.errors.donor_email?"border-red-500 focus:border-red-500":""),disabled:g}),ge.touched.donor_email&&ge.errors.donor_email&&r.jsx("p",{className:"text-sm text-red-600",children:ge.errors.donor_email})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"donor_phone",children:"Telefon"}),r.jsx(w,{id:"donor_phone",type:"tel",value:ge.values.donor_phone,onChange:e=>{ge.handleChange("donor_phone",e.target.value)},onBlur:()=>{ge.handleBlur("donor_phone")},placeholder:"0555 123 45 67",className:"focus-corporate min-h-[44px] "+(ge.touched.donor_phone&&ge.errors.donor_phone?"border-red-500 focus:border-red-500":""),disabled:g}),ge.touched.donor_phone&&ge.errors.donor_phone&&r.jsx("p",{className:"text-sm text-red-600",children:ge.errors.donor_phone})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"amount",children:"Miktar (TL) *"}),r.jsx(w,{id:"amount",type:"number",value:ge.values.amount,onChange:e=>{ge.handleChange("amount",e.target.value)},onBlur:()=>{ge.handleBlur("amount")},placeholder:"0.00",className:"focus-corporate min-h-[44px] "+(ge.touched.amount&&ge.errors.amount?"border-red-500 focus:border-red-500":""),disabled:g,min:"0",step:"0.01"}),ge.touched.amount&&ge.errors.amount&&r.jsx("p",{className:"text-sm text-red-600",children:ge.errors.amount})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"donation_type",children:"Bağış Türü"}),r.jsxs(k,{value:ge.values.donation_type,onValueChange:e=>{ge.handleChange("donation_type",e)},children:[r.jsx(_,{className:"focus-corporate min-h-[44px]",children:r.jsx(B,{})}),r.jsxs(T,{children:[r.jsx(C,{value:"cash",children:"Nakdi"}),r.jsx(C,{value:"in_kind",children:"Ayni"}),r.jsx(C,{value:"services",children:"Hizmet"}),r.jsx(C,{value:"other",children:"Diğer"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"payment_method",children:"Ödeme Yöntemi"}),r.jsxs(k,{value:ge.values.payment_method,onValueChange:e=>{ge.handleChange("payment_method",e)},children:[r.jsx(_,{className:"focus-corporate min-h-[44px]",children:r.jsx(B,{})}),r.jsxs(T,{children:[r.jsx(C,{value:"bank_transfer",children:"Banka Havalesi"}),r.jsx(C,{value:"credit_card",children:"Kredi Kartı"}),r.jsx(C,{value:"cash",children:"Nakit"}),r.jsx(C,{value:"check",children:"Çek"}),r.jsx(C,{value:"online",children:"Online"}),r.jsx(C,{value:"other",children:"Diğer"})]})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"category",children:"Kategori"}),r.jsx(w,{id:"category",value:ge.values.category,onChange:e=>{ge.handleChange("category",e.target.value)},onBlur:()=>{ge.handleBlur("category")},placeholder:"Bağış kategorisi (örn: Eğitim, Sağlık)",className:"focus-corporate min-h-[44px]",disabled:g}),ge.touched.category&&ge.errors.category&&r.jsx("p",{className:"text-sm text-red-600",children:ge.errors.category})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"description",children:"Açıklama"}),r.jsx(K,{id:"description",value:ge.values.description,onChange:e=>{ge.handleChange("description",e.target.value)},onBlur:()=>{ge.handleBlur("description")},placeholder:"Bağış hakkında ek bilgiler...",className:"focus-corporate min-h-[80px]",disabled:g}),ge.touched.description&&ge.errors.description&&r.jsx("p",{className:"text-sm text-red-600",children:ge.errors.description})]})]}),r.jsxs("div",{className:"flex flex-col justify-end gap-3 border-t pt-6 sm:flex-row",children:[r.jsx(z,{variant:"outline",onClick:()=>{he(!1),ge.reset()},className:"min-h-[44px] px-6",disabled:g,children:"İptal"}),r.jsx(z,{variant:"default",onClick:()=>{ge.isValid&&fe(ge.values)},className:"min-h-[44px] px-6 shadow-md hover:shadow-lg corporate-gradient",disabled:g||!ge.isValid,children:g?r.jsxs(r.Fragment,{children:[r.jsx(c,{className:"mr-2 h-4 w-4 animate-spin"}),"Kaydediliyor..."]}):r.jsxs(r.Fragment,{children:[r.jsx(d,{className:"mr-2 h-4 w-4"}),"Kaydet"]})})]})]})]})]}),children:r.jsxs("div",{className:"safe-area space-y-4 p-3 sm:space-y-6 sm:p-6 lg:p-8",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4 md:grid-cols-4",children:[r.jsx(v,{className:"professional-card micro-interaction",children:r.jsx(f,{className:"p-3 sm:p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"text-lg font-semibold text-green-600 sm:text-xl lg:text-2xl",children:["₺",(pe.totalAmount??0).toLocaleString()]}),r.jsx("p",{className:"text-xs font-medium text-gray-600 sm:text-sm",children:"Toplam Bağış"})]}),r.jsx(t,{className:"h-8 w-8 text-green-500 opacity-80"})]})})}),r.jsx(v,{className:"professional-card micro-interaction",children:r.jsx(f,{className:"p-3 sm:p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-lg font-semibold text-blue-600 sm:text-xl lg:text-2xl",children:pe.total??0}),r.jsx("p",{className:"text-xs font-medium text-gray-600 sm:text-sm",children:"Toplam İşlem"})]}),r.jsx(n,{className:"h-8 w-8 text-blue-500 opacity-80"})]})})}),r.jsx(v,{className:"professional-card micro-interaction",children:r.jsx(f,{className:"p-3 sm:p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-lg font-semibold text-yellow-600 sm:text-xl lg:text-2xl",children:pe.pending??0}),r.jsx("p",{className:"text-xs font-medium text-gray-600 sm:text-sm",children:"Bekleyen"})]}),r.jsx(i,{className:"h-8 w-8 text-yellow-500 opacity-80"})]})})}),r.jsx(v,{className:"professional-card micro-interaction",children:r.jsx(f,{className:"p-3 sm:p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"text-lg font-semibold text-emerald-600 sm:text-xl lg:text-2xl",children:["₺",(pe.averageAmount??0).toLocaleString()]}),r.jsx("p",{className:"text-xs font-medium text-gray-600 sm:text-sm",children:"Ortalama"})]}),r.jsx(l,{className:"h-8 w-8 text-emerald-500 opacity-80"})]})})})]}),r.jsxs(v,{className:"border-none shadow-md",children:[r.jsx(b,{className:"pb-4",children:r.jsxs("div",{className:"space-y-4",children:[r.jsx(N,{className:"text-lg sm:text-xl",children:"Bağış Listesi"}),r.jsxs("div",{className:"space-y-3 sm:flex sm:gap-4 sm:space-y-0",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(s,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 transform text-gray-400"}),r.jsx(w,{placeholder:"Bağışçı adı, e-posta veya referans ara...",value:P,onChange:e=>{Q(e.target.value)},className:"focus-corporate min-h-[44px] pl-10 text-sm sm:text-base",inputMode:"search"})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-3 sm:gap-3 lg:flex lg:w-auto",children:[r.jsxs(k,{value:W,onValueChange:ae,children:[r.jsx(_,{className:"focus-corporate min-h-[44px] text-sm sm:text-base",children:r.jsx(B,{placeholder:"Tüm Durumlar"})}),r.jsxs(T,{children:[r.jsx(C,{value:"all",children:"Tüm Durumlar"}),r.jsx(C,{value:"pending",children:"Beklemede"}),r.jsx(C,{value:"approved",children:"Onaylandı"}),r.jsx(C,{value:"rejected",children:"Reddedildi"}),r.jsx(C,{value:"processing",children:"İşleniyor"}),r.jsx(C,{value:"completed",children:"Tamamlandı"})]})]}),r.jsxs(k,{value:re,onValueChange:te,children:[r.jsx(_,{className:"focus-corporate min-h-[44px] text-sm sm:text-base",children:r.jsx(B,{placeholder:"Tüm Türler"})}),r.jsxs(T,{children:[r.jsx(C,{value:"all",children:"Tüm Türler"}),r.jsx(C,{value:"cash",children:"Nakdi"}),r.jsx(C,{value:"in_kind",children:"Ayni"}),r.jsx(C,{value:"services",children:"Hizmet"}),r.jsx(C,{value:"other",children:"Diğer"})]})]}),r.jsxs(k,{value:ne,onValueChange:ie,children:[r.jsx(_,{className:"focus-corporate min-h-[44px] text-sm sm:text-base",children:r.jsx(B,{placeholder:"Tüm Ödeme Yöntemleri"})}),r.jsxs(T,{children:[r.jsx(C,{value:"all",children:"Tüm Ödeme Yöntemleri"}),r.jsx(C,{value:"bank_transfer",children:"Banka Havalesi"}),r.jsx(C,{value:"credit_card",children:"Kredi Kartı"}),r.jsx(C,{value:"cash",children:"Nakit"}),r.jsx(C,{value:"check",children:"Çek"}),r.jsx(C,{value:"online",children:"Online"}),r.jsx(C,{value:"other",children:"Diğer"})]})]})]})]})]})}),r.jsx(f,{className:"p-0",children:r.jsx(j,{data:le,columns:we,loading:e,mobileCardRenderer:e=>r.jsx(v,{className:"border border-gray-200 transition-shadow hover:shadow-md",children:r.jsxs(f,{className:"p-4",children:[r.jsxs("div",{className:"mb-3 flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"font-medium text-gray-900",children:e.donor_name}),r.jsx("p",{className:"text-sm text-gray-600",children:e.category??e.donation_type})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("div",{className:"text-lg font-semibold text-green-600",children:["₺",e.amount.toLocaleString()]}),ve(e.status)]})]}),r.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[r.jsx("span",{children:e.payment_method}),r.jsx("span",{children:D(e.created_at)})]}),r.jsxs("div",{className:"mt-3 flex flex-wrap justify-end gap-2",children:["pending"===e.status&&r.jsxs(r.Fragment,{children:[r.jsxs(S,{children:[r.jsx(M,{asChild:!0,children:r.jsx(z,{variant:"ghost",size:"sm",className:"min-h-[44px] min-w-[44px] p-2 text-green-600 hover:bg-green-50 hover:text-green-700",onClick:a=>{a.stopPropagation(),be(e.id,"approved")},"aria-label":`Approve donation from ${e.donor_name}`,children:r.jsx(l,{className:"h-4 w-4"})})}),r.jsx(R,{children:"Onayla"})]}),r.jsxs(S,{children:[r.jsx(M,{asChild:!0,children:r.jsx(z,{variant:"ghost",size:"sm",className:"min-h-[44px] min-w-[44px] p-2 text-red-600 hover:bg-red-50 hover:text-red-700",onClick:a=>{a.stopPropagation(),be(e.id,"rejected")},"aria-label":`Reject donation from ${e.donor_name}`,children:r.jsx(m,{className:"h-4 w-4"})})}),r.jsx(R,{children:"Reddet"})]})]}),r.jsx(z,{variant:"ghost",size:"sm",className:"min-h-[44px] min-w-[44px] p-2 text-red-600 hover:bg-red-50 hover:text-red-700",onClick:a=>{a.stopPropagation(),Ne(e.id)},"aria-label":"Sil",children:h.createElement(q.delete,{className:"h-4 w-4"})})]})]})},e.id),stickyHeader:!0,emptyState:r.jsx(V,{title:"Henüz bağış kaydı bulunmuyor",description:'Yeni bağış eklemek için "Yeni Bağış" butonunu kullanın'})})})]})]})})}import{r as a,j as r,bP as t,a1 as n,o as i,s as l,l as s,a2 as o,aa as d,L as c,q as m,a4 as h}from"./react-vendor-Zi_jsHoK.js";import{l as p,d as u,a6 as g,a5 as x,Y as y,C as v,e as f,a as b,b as N,I as w,S as k,j as _,k as B,m as T,n as C,a7 as j,a8 as V,B as z,a9 as D,o as $,K as E,p as L,q as O,r as A,s as F,t as Y,v as K,_ as S,$ as M,a0 as R,aa as q,ab as H}from"./beneficiaries-page-CkZlrYV8.js";import{t as G}from"./toast-vendor-Ci27VDWJ.js";import{Q as I,I as P}from"./appwrite-vendor-Ct7vfU_L.js";import"./ui-vendor-f6_gbUtQ.js";import"./utils-vendor-CH-VcvGo.js";import"./motion-vendor-iBxafAnt.js";const Q={email:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,phone:/^(\+90|0)?[5][0-9]{9}$/,tcKimlik:/^[1-9][0-9]{10}$/,iban:/^TR[0-9]{2}[0-9]{4}[0-9]{16}$/,url:/^https?:\/\/.+/},U=(e,a)=>!e||"string"==typeof e&&""===e.trim()?{isValid:!1,error:`${a} alanı zorunludur`}:{isValid:!0},Z=(e,a,r)=>e.length<a?{isValid:!1,error:`${r} en az ${a} karakter olmalıdır`}:{isValid:!0},J=(e,a,r)=>e.length>a?{isValid:!1,error:`${r} en fazla ${a} karakter olabilir`}:{isValid:!0},W=(e,a,r,t)=>{const n="string"==typeof e?parseFloat(e):e;return isNaN(n)?{isValid:!1,error:`${t??"Değer"} geçerli bir sayı olmalıdır`}:void 0!==a&&n<a?{isValid:!1,error:`${t??"Değer"} en az ${a} olmalıdır`}:void 0!==r&&n>r?{isValid:!1,error:`${t??"Değer"} en fazla ${r} olabilir`}:{isValid:!0}},X={donation:{donor_name:{required:!0,minLength:2,maxLength:255},donor_email:{pattern:Q.email},donor_phone:{pattern:Q.phone},amount:{required:!0,custom:e=>(e=>{const a="string"==typeof e?parseFloat(e):e;return isNaN(a)||a<=0?{isValid:!1,error:"Miktar pozitif bir sayı olmalıdır"}:{isValid:!0}})(e)},description:{maxLength:1e3}},member:{name:{required:!0,minLength:2,maxLength:255},email:{required:!0,pattern:Q.email},phone:{pattern:Q.phone},address:{maxLength:500},annual_fee:{custom:e=>W(e,0,void 0,"Yıllık Aidat")}},beneficiary:{ad_soyad:{required:!0,minLength:2,maxLength:255},kimlik_no:{required:!0,custom:e=>(e=>{if(!Q.tcKimlik.test(e))return{isValid:!1,error:"Geçerli bir TC Kimlik numarası giriniz"};const a=e.split("").map(Number);return(7*(a[0]+a[2]+a[4]+a[6]+a[8])-(a[1]+a[3]+a[5]+a[7]))%10!==a[9]?{isValid:!1,error:"Geçersiz TC Kimlik numarası"}:{isValid:!0}})(e)},telefon_no:{pattern:Q.phone},email:{pattern:Q.email},adres:{maxLength:500},toplam_tutar:{custom:e=>W(e,0,void 0,"Toplam Tutar")},iban:{custom:e=>(e=>{const a=e.replace(/\s/g,"").toUpperCase();return Q.iban.test(a)?{isValid:!0}:{isValid:!1,error:"Geçerli bir IBAN numarası giriniz"}})(e)}}},ee=new class{async getDonations(e={}){const{page:a=1,limit:r=50,status:t,donation_type:n,payment_method:i,date_from:l,date_to:s}=e;try{const e=[I.limit(r),I.offset((a-1)*r),I.orderDesc("donation_date")];return t&&e.push(I.equal("status",t)),n&&e.push(I.equal("donation_type",n)),i&&e.push(I.equal("payment_method",i)),l&&e.push(I.greaterThanEqual("donation_date",l)),s&&e.push(I.lessThanEqual("donation_date",s)),(await u.listDocuments(g.DATABASE_ID,g.DONATIONS,e)).documents}catch(o){throw new Error("Bağışlar listelenemedi")}}async getDonation(e){try{return await u.getDocument(g.DATABASE_ID,g.DONATIONS,e)}catch(a){return null}}async createDonation(e){try{return await u.createDocument(g.DATABASE_ID,g.DONATIONS,P.unique(),{donor_name:e.donor_name,amount:e.amount,currency:e.currency||"TRY",donation_type:e.donation_type,payment_method:e.payment_method,status:e.status||"pending",donation_date:e.donation_date||(new Date).toISOString(),notes:e.notes,...e})}catch(a){throw new Error("Bağış oluşturulamadı")}}async updateDonation(e,a){try{return await u.updateDocument(g.DATABASE_ID,g.DONATIONS,e,a)}catch(r){throw new Error("Bağış güncellenemedi")}}async deleteDonation(e){try{return await u.deleteDocument(g.DATABASE_ID,g.DONATIONS,e),!0}catch(a){throw new Error("Bağış silinemedi")}}async getDonationStats(){try{const e=(await u.listDocuments(g.DATABASE_ID,g.DONATIONS)).documents,a={total:e.length,totalAmount:e.reduce((e,a)=>e+a.amount,0),averageAmount:0,byStatus:{},byType:{},byPaymentMethod:{}};return a.averageAmount=a.total>0?a.totalAmount/a.total:0,e.forEach(e=>{a.byStatus[e.status]=(a.byStatus[e.status]||0)+1,a.byType[e.donation_type]=(a.byType[e.donation_type]||0)+1,a.byPaymentMethod[e.payment_method]=(a.byPaymentMethod[e.payment_method]||0)+1}),a}catch(e){throw new Error("Bağış istatistikleri getirilemedi")}}};export{e as DonationsPage,e as default};
