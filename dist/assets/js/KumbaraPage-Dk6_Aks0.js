function e(e){return`QR-${e}-${(new Date).getFullYear()}`}function a(){return Math.random().toString(36).substr(2,9)}function r(){const[e,a]=t.useState(!0),[r,f]=t.useState(""),[G,U]=t.useState("all"),[H,V]=t.useState([]),[J,W]=t.useState(null),[X,Z]=t.useState(!1),[ee,ae]=t.useState(!1),[re,te]=t.useState({name:"",location:"",address:"",contactPerson:"",phone:"",notes:""}),{toast:ne}=Y();t.useEffect(()=>{le()},[]);const le=async()=>{try{a(!0);const e=await I.getKumbaras();V(e.kumbaras||[])}catch(e){ne("Kumbaralar yüklenirken hata oluştu")}finally{a(!1)}},se=H.filter(e=>{const a=e.name.toLowerCase().includes(r.toLowerCase())||e.location.toLowerCase().includes(r.toLowerCase())||e.code.toLowerCase().includes(r.toLowerCase()),t="all"===G||e.status===G;return a&&t}),oe=e=>{const a=window.open("","_blank"),r=`\n      <html>\n        <head>\n          <title>Kumbara QR Kod - ${e.code}</title>\n          <style>\n            @page { size: 40mm 30mm; margin: 2mm; }\n            body { \n              font-family: Arial, sans-serif; \n              margin: 0; \n              padding: 0;\n              display: flex;\n              flex-direction: column;\n              align-items: center;\n              justify-content: center;\n              height: 26mm;\n              width: 36mm;\n            }\n            .qr-container {\n              text-align: center;\n              border: 1px solid #ddd;\n              padding: 2mm;\n              border-radius: 2mm;\n            }\n            .qr-placeholder {\n              width: 20mm;\n              height: 20mm;\n              border: 2px solid #333;\n              margin: 0 auto 1mm auto;\n              display: flex;\n              align-items: center;\n              justify-content: center;\n              font-size: 8px;\n              background: #f9f9f9;\n            }\n            .qr-info {\n              font-size: 6px;\n              margin: 0;\n              line-height: 1.2;\n            }\n            .qr-code {\n              font-weight: bold;\n              margin-bottom: 0.5mm;\n            }\n          </style>\n        </head>\n        <body>\n          <div class="qr-container">\n            <div class="qr-placeholder">QR KOD</div>\n            <div class="qr-info qr-code">${e.code}</div>\n            <div class="qr-info">${e.name}</div>\n            <div class="qr-info">${e.location}</div>\n          </div>\n        </body>\n      </html>\n    `;a&&(a.document.write(r),a.document.close(),a.focus(),setTimeout(()=>{a.print(),a.close()},500))},ie=H.length,de=H.filter(e=>"active"===e.status).length,ce=H.reduce((e,a)=>e+a.totalAmount,0),me=H.reduce((e,a)=>e+a.monthlyAverage,0);return e?n.jsx(p,{}):n.jsx(v,{title:"Kumbara Takibi",subtitle:"Kumbara yerleştirme, takip ve gelir yönetimi",actions:n.jsxs("div",{className:"flex gap-3",children:[n.jsxs($,{variant:"outline",size:"sm",className:"h-10 px-4 border-slate-200 hover:bg-slate-50 rounded-xl shadow-sm",children:[n.jsx(g,{className:"w-4 h-4 mr-2"}),"Rapor Al"]}),n.jsxs($,{size:"sm",onClick:()=>{Z(!0)},className:"h-10 px-4 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 rounded-xl shadow-lg",children:[n.jsx(b,{className:"w-4 h-4 mr-2"}),"Yeni Kumbara"]})]}),children:n.jsxs("div",{className:"p-8 space-y-8 bg-gradient-to-br from-slate-50/50 to-blue-50/30",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[n.jsx(x,{className:"border border-gray-200 dark:border-gray-700 dark:bg-gray-900 shadow-lg hover:shadow-xl transition-all duration-300 group bg-gradient-to-br from-blue-50 to-indigo-50 hover:from-blue-100 hover:to-indigo-100",children:n.jsx(y,{className:"p-6",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300",children:n.jsx(l,{className:"w-7 h-7 text-white"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"text-3xl font-bold text-slate-700 mb-1",children:ie}),n.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Toplam Kumbara"})]})]})})}),n.jsx(x,{className:"border border-gray-200 dark:border-gray-700 dark:bg-gray-900 shadow-lg hover:shadow-xl transition-all duration-300 group bg-gradient-to-br from-emerald-50 to-green-50 hover:from-emerald-100 hover:to-green-100",children:n.jsx(y,{className:"p-6",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-emerald-500 to-green-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300",children:n.jsx(s,{className:"w-7 h-7 text-white"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"text-3xl font-bold text-slate-700 mb-1",children:de}),n.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Aktif Kumbara"})]})]})})}),n.jsx(x,{className:"border border-gray-200 dark:border-gray-700 dark:bg-gray-900 shadow-lg hover:shadow-xl transition-all duration-300 group bg-gradient-to-br from-violet-50 to-purple-50 hover:from-violet-100 hover:to-purple-100",children:n.jsx(y,{className:"p-6",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300",children:n.jsx(o,{className:"w-7 h-7 text-white"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"text-3xl font-bold text-slate-700 mb-1",children:["₺",ce.toLocaleString()]}),n.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Toplam Gelir"})]})]})})}),n.jsx(x,{className:"border border-gray-200 dark:border-gray-700 dark:bg-gray-900 shadow-lg hover:shadow-xl transition-all duration-300 group bg-gradient-to-br from-amber-50 to-orange-50 hover:from-amber-100 hover:to-orange-100",children:n.jsx(y,{className:"p-6",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-amber-500 to-orange-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300",children:n.jsx(i,{className:"w-7 h-7 text-white"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"text-3xl font-bold text-slate-700 mb-1",children:["₺",me.toLocaleString()]}),n.jsx("p",{className:"text-sm text-slate-500 font-medium",children:"Aylık Ortalama"})]})]})})})]}),n.jsxs(x,{className:"border border-gray-200 dark:border-gray-700 dark:bg-gray-900 shadow-xl bg-white/80 backdrop-blur-sm",children:[n.jsx(N,{className:"pb-6",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 items-start sm:items-center justify-between",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(w,{className:"text-2xl text-slate-800",children:"Kumbara Listesi"}),n.jsx("p",{className:"text-slate-500",children:"Tüm kumbara konumlarını görüntüleyin ve yönetin"})]}),n.jsxs("div",{className:"flex gap-3 w-full sm:w-auto",children:[n.jsxs("div",{className:"relative flex-1 sm:w-72",children:[n.jsx(d,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),n.jsx(k,{placeholder:"Kumbara ara...",value:r,onChange:e=>{f(e.target.value)},className:"pl-12 h-11 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20 rounded-xl shadow-sm"})]}),n.jsxs(_,{value:G,onValueChange:U,children:[n.jsx(K,{className:"w-40 h-11 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20 rounded-xl shadow-sm",children:n.jsx(z,{placeholder:"Durum"})}),n.jsxs(E,{className:"rounded-xl border-slate-200 shadow-xl",children:[n.jsx(j,{value:"all",children:"Tüm Durumlar"}),n.jsx(j,{value:"active",children:"Aktif"}),n.jsx(j,{value:"inactive",children:"Pasif"}),n.jsx(j,{value:"maintenance",children:"Bakımda"}),n.jsx(j,{value:"damaged",children:"Hasarlı"}),n.jsx(j,{value:"removed",children:"Kaldırıldı"})]})]})]})]})}),n.jsx(y,{className:"pt-0",children:n.jsx("div",{className:"rounded-xl overflow-hidden border border-slate-200",children:n.jsxs(D,{children:[n.jsx(q,{children:n.jsxs(C,{className:"bg-slate-50/80 hover:bg-slate-50/80 border-slate-200",children:[n.jsx(A,{className:"font-semibold text-slate-700",children:"Kumbara Kodu"}),n.jsx(A,{className:"font-semibold text-slate-700",children:"İsim & Lokasyon"}),n.jsx(A,{className:"font-semibold text-slate-700",children:"Durum"}),n.jsx(A,{className:"font-semibold text-slate-700",children:"Son Toplama"}),n.jsx(A,{className:"font-semibold text-slate-700",children:"Toplam Gelir"}),n.jsx(A,{className:"font-semibold text-slate-700",children:"Aylık Ort."}),n.jsx(A,{className:"text-right font-semibold text-slate-700",children:"İşlemler"})]})}),n.jsx(T,{children:se.map((e,a)=>{return n.jsxs(C,{className:"hover:bg-blue-50/50 transition-colors duration-200 border-slate-100 "+(a%2==0?"bg-white":"bg-slate-50/30"),children:[n.jsx(R,{className:"py-4",children:n.jsx("div",{className:"font-mono font-bold text-blue-600 bg-blue-50 px-3 py-1 rounded-lg inline-block",children:e.code})}),n.jsx(R,{className:"py-4",children:n.jsxs("div",{className:"space-y-1",children:[n.jsx("div",{className:"font-semibold text-slate-800",children:e.name}),n.jsxs("div",{className:"text-sm text-slate-500 flex items-center gap-2",children:[n.jsx(c,{className:"w-4 h-4 text-slate-400"}),e.location]})]})}),n.jsx(R,{className:"py-4",children:(r=e.status,n.jsx(S,{variant:{active:"success",inactive:"outline",maintenance:"warning",damaged:"destructive",removed:"secondary"}[r],size:"lg",className:"font-semibold",children:{active:"Aktif",inactive:"Pasif",maintenance:"Bakımda",damaged:"Hasarlı",removed:"Kaldırıldı"}[r]}))}),n.jsx(R,{className:"text-slate-600 py-4 font-medium",children:e.lastCollection?new Date(e.lastCollection).toLocaleDateString("tr-TR"):"Henüz toplanmadı"}),n.jsxs(R,{className:"font-bold text-emerald-600 py-4",children:["₺",e.totalAmount.toLocaleString()]}),n.jsxs(R,{className:"font-bold text-blue-600 py-4",children:["₺",e.monthlyAverage.toLocaleString()]}),n.jsx(R,{className:"text-right py-4",children:n.jsxs("div",{className:"flex gap-1 justify-end",children:[n.jsx($,{variant:"ghost",size:"sm",className:"h-9 w-9 rounded-lg hover:bg-blue-100 hover:text-blue-600 transition-colors",onClick:()=>{W(e),ae(!0)},children:n.jsx(l,{className:"w-4 h-4"})}),n.jsx($,{variant:"ghost",size:"sm",className:"h-9 w-9 rounded-lg hover:bg-purple-100 hover:text-purple-600 transition-colors",onClick:()=>{oe(e)},children:n.jsx(m,{className:"w-4 h-4"})}),n.jsx($,{variant:"ghost",size:"sm",className:"h-9 w-9 rounded-lg hover:bg-green-100 hover:text-green-600 transition-colors",children:n.jsx(h,{className:"w-4 h-4"})}),n.jsx($,{variant:"ghost",size:"sm",className:"h-9 w-9 rounded-lg hover:bg-amber-100 hover:text-amber-600 transition-colors",children:n.jsx(u,{className:"w-4 h-4"})})]})})]},e.id);var r})})]})})})]}),n.jsx(Q,{open:X,onOpenChange:Z,children:n.jsxs(O,{className:"max-w-lg border border-gray-200 dark:border-gray-700 dark:bg-gray-900 shadow-2xl rounded-2xl bg-white",children:[n.jsxs(P,{className:"space-y-3 pb-6",children:[n.jsxs(B,{className:"text-2xl text-slate-800 flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center",children:n.jsx(b,{className:"w-5 h-5 text-white"})}),"Yeni Kumbara Ekle"]}),n.jsx(F,{className:"text-slate-600 leading-relaxed",children:"Yeni kumbara konumu ekleyin ve otomatik QR kod üretimi için gerekli bilgileri doldurun."})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-3",children:[n.jsx(L,{htmlFor:"name",className:"text-slate-700 font-semibold",children:"Kumbara Adı"}),n.jsx(k,{id:"name",placeholder:"Merkez Camii Kumbarası",className:"h-11 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20 rounded-xl",value:re.name,onChange:e=>{te(a=>({...a,name:e.target.value}))}})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(L,{htmlFor:"location",className:"text-slate-700 font-semibold",children:"Lokasyon"}),n.jsx(k,{id:"location",placeholder:"Fatih Camii",className:"h-11 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20 rounded-xl",value:re.location,onChange:e=>{te(a=>({...a,location:e.target.value}))}})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(L,{htmlFor:"address",className:"text-slate-700 font-semibold",children:"Adres"}),n.jsx(M,{id:"address",placeholder:"Tam adres bilgisi...",rows:3,className:"border-slate-200 focus:border-blue-500 focus:ring-blue-500/20 rounded-xl resize-none",value:re.address,onChange:e=>{te(a=>({...a,address:e.target.value}))}})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-3",children:[n.jsx(L,{htmlFor:"contact",className:"text-slate-700 font-semibold",children:"İletişim Kişisi"}),n.jsx(k,{id:"contact",placeholder:"Ahmet Öztürk",className:"h-11 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20 rounded-xl",value:re.contactPerson,onChange:e=>{te(a=>({...a,contactPerson:e.target.value}))}})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(L,{htmlFor:"phone",className:"text-slate-700 font-semibold",children:"Telefon"}),n.jsx(k,{id:"phone",placeholder:"0532 123 45 67",className:"h-11 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20 rounded-xl",value:re.phone,onChange:e=>{te(a=>({...a,phone:e.target.value}))}})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(L,{htmlFor:"notes",className:"text-slate-700 font-semibold",children:"Notlar"}),n.jsx(M,{id:"notes",placeholder:"Özel notlar...",rows:3,className:"border-slate-200 focus:border-blue-500 focus:ring-blue-500/20 rounded-xl resize-none",value:re.notes,onChange:e=>{te(a=>({...a,notes:e.target.value}))}})]}),n.jsxs("div",{className:"flex gap-4 pt-6 border-t border-slate-100",children:[n.jsx($,{variant:"outline",className:"flex-1 h-12 border-slate-200 hover:bg-slate-50 rounded-xl",onClick:()=>{Z(!1)},children:"İptal"}),n.jsxs($,{className:"flex-1 h-12 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 rounded-xl shadow-lg",onClick:async()=>{try{const e={name:re.name,location:re.location,address:re.address,contactPerson:re.contactPerson||void 0,phone:re.phone||void 0,notes:re.notes||void 0,status:"active",created_by:"current-user"};await I.createKumbara(e)?(ne("Kumbara başarıyla eklendi"),Z(!1),te({name:"",location:"",address:"",contactPerson:"",phone:"",notes:""}),le()):ne("Kumbara eklenirken hata oluştu")}catch(e){ne("Kumbara eklenirken hata oluştu")}},children:[n.jsx(l,{className:"w-5 h-5 mr-2"}),"QR Kod ile Ekle"]})]})]})]})}),n.jsx(Q,{open:ee,onOpenChange:ae,children:n.jsxs(O,{className:"max-w-md border border-gray-200 dark:border-gray-700 dark:bg-gray-900 shadow-2xl rounded-2xl bg-white",children:[n.jsxs(P,{className:"space-y-3 pb-6",children:[n.jsxs(B,{className:"text-2xl text-slate-800 flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl flex items-center justify-center",children:n.jsx(l,{className:"w-5 h-5 text-white"})}),"QR Kod - ",J?.code]}),n.jsx(F,{className:"text-slate-600 leading-relaxed",children:"Kumbara için benzersiz QR kodu görüntüleyin ve 40x30mm boyutunda yazdırın."})]}),J&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-gradient-to-br from-slate-50 to-blue-50 p-8 rounded-2xl text-center border border-slate-100",children:[n.jsx("div",{className:"w-40 h-40 mx-auto bg-white border-2 border-slate-200 rounded-2xl flex items-center justify-center mb-6 shadow-lg",children:n.jsxs("div",{className:"text-center",children:[n.jsx(l,{className:"w-20 h-20 mx-auto text-slate-400 mb-3"}),n.jsx("div",{className:"text-xs text-slate-500 font-medium",children:"QR Kod Simülasyonu"})]})}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"text-lg font-bold text-slate-800",children:J.name}),n.jsxs("div",{className:"text-sm text-slate-600 flex items-center justify-center gap-2",children:[n.jsx(c,{className:"w-4 h-4"}),J.location]}),n.jsx("div",{className:"text-sm font-mono text-blue-600 bg-blue-100 px-3 py-1 rounded-lg inline-block mt-3",children:J.code})]})]}),n.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-2xl border border-blue-100",children:[n.jsx("div",{className:"font-semibold text-blue-800 mb-3 flex items-center gap-2",children:"📱 QR Kod Bilgileri"}),n.jsxs("div",{className:"space-y-2 text-blue-700",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"font-medium",children:"Kumbara ID:"}),n.jsx("span",{children:J.id})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"font-medium",children:"Kod:"}),n.jsx("span",{className:"font-mono",children:J.code})]}),n.jsxs("div",{className:"pt-2",children:[n.jsx("span",{className:"font-medium",children:"URL:"}),n.jsxs("div",{className:"text-xs bg-white p-2 rounded-lg mt-1 font-mono break-all",children:["bagis.dernek.org/kumbara/",J.code]})]})]})]}),n.jsxs("div",{className:"flex gap-4 pt-4 border-t border-slate-100",children:[n.jsxs($,{variant:"outline",className:"flex-1 h-12 border-slate-200 hover:bg-slate-50 rounded-xl",onClick:()=>{oe(J)},children:[n.jsx(m,{className:"w-5 h-5 mr-2"}),"40x30mm Yazdır"]}),n.jsxs($,{className:"flex-1 h-12 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 rounded-xl shadow-lg",onClick:()=>{navigator.clipboard.writeText((e=>{const a={kumbaraId:e.id,code:e.code,name:e.name,location:e.location,url:`https://bagis.dernek.org/kumbara/${e.code}`};return JSON.stringify(a)})(J))},children:[n.jsx(g,{className:"w-5 h-5 mr-2"}),"Kodu Kopyala"]})]})]})]})})]})})}import{r as t,j as n,cb as l,a1 as s,bP as o,a9 as i,l as d,ar as c,cc as m,E as h,a7 as u,aa as b,a2 as g}from"./react-vendor-Zi_jsHoK.js";import{l as f,a5 as p,Y as v,C as x,e as y,a as N,b as w,I as k,S as _,j as K,k as z,m as E,n as j,M as D,N as q,O as C,Q as A,V as T,W as R,B as $,o as Q,p as O,q as P,r as B,s as F,t as L,v as M,f as S}from"./beneficiaries-page-CkZlrYV8.js";import{u as Y}from"./user-management-page-B6-AaFFc.js";import"./ui-vendor-f6_gbUtQ.js";import"./utils-vendor-CH-VcvGo.js";import"./toast-vendor-Ci27VDWJ.js";import"./appwrite-vendor-Ct7vfU_L.js";import"./motion-vendor-iBxafAnt.js";import"./messaging-page-BEU6nUaR.js";import"./events-finance-page-DWyC3OLf.js";const I={async getKumbaras(e={}){try{let a=[];if(e.status&&e.status.length>0&&(a=a.filter(a=>e.status.includes(a.status))),e.search_term){const r=e.search_term.toLowerCase();a=a.filter(e=>e.name.toLowerCase().includes(r)||e.location.toLowerCase().includes(r)||e.code.toLowerCase().includes(r))}return e.sort_by&&a.sort((a,r)=>{let t,n;switch(e.sort_by){case"name":t=a.name,n=r.name;break;case"location":t=a.location,n=r.location;break;case"amount":t=a.totalAmount,n=r.totalAmount;break;case"last_collection":t=new Date(a.lastCollection||0),n=new Date(r.lastCollection||0);break;default:t=a.created_at,n=r.created_at}return"desc"===e.sort_order?t>n?-1:t<n?1:0:t<n?-1:t>n?1:0}),{kumbaras:a,total_count:a.length,page:1,page_size:a.length,total_pages:1,filters_applied:e}}catch(a){throw f.error("Error fetching kumbaras:",a),new Error("Kumbara listesi alınamadı")}},async getKumbara(e){try{const a=(await I.getKumbaras()).kumbaras.find(a=>a.id===e);if(!a)throw new Error("Kumbara bulunamadı");return a}catch(a){throw f.error("Error fetching kumbara:",a),new Error("Kumbara bilgileri alınamadı")}},async createKumbara(r){try{const t=r.code||`KMB-${Date.now().toString().slice(-6)}-${Math.floor(100*Math.random()).toString().padStart(2,"0")}`;return{id:a(),code:t,name:r.name,location:r.location,address:r.address,status:r.status||"active",installDate:r.installDate||(new Date).toISOString().split("T")[0],lastCollection:null,totalAmount:0,monthlyAverage:0,qrCode:e(t),contactPerson:r.contactPerson,phone:r.phone,notes:r.notes,coordinates:r.coordinates,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),created_by:r.created_by}}catch(t){throw f.error("Error creating kumbara:",t),new Error("Kumbara oluşturulamadı")}},async updateKumbara(e,a){try{return{...await I.getKumbara(e),...a,updated_at:(new Date).toISOString()}}catch(r){throw f.error("Error updating kumbara:",r),new Error("Kumbara güncellenemedi")}},async deleteKumbara(e,a){try{return!0}catch(r){throw f.error("Error deleting kumbara:",r),new Error("Kumbara silinemedi")}},async recordCollection(e){try{return{id:a(),kumbara_id:e.kumbara_id,collection_date:e.collection_date||(new Date).toISOString(),amount:e.amount,currency:e.currency||"TRY",collector_name:e.collector_name,collector_id:e.collector_id||"",notes:e.notes||"",witness_name:e.witness_name||"",witness_phone:e.witness_phone||"",verification_photos:e.verification_photos||[],weather_condition:e.weather_condition||"",collection_method:e.collection_method||"scheduled",created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),created_by:e.created_by}}catch(r){throw f.error("Error recording collection:",r),new Error("Toplama kaydı oluşturulamadı")}},async getCollections(e,a=10){try{return[]}catch(r){throw f.error("Error fetching collections:",r),new Error("Toplama kayıtları alınamadı")}},async getDashboardStats(){try{const e=await I.getKumbaras();return{total_kumbaras:e.kumbaras.length,active_kumbaras:e.kumbaras.filter(e=>"active"===e.status).length,inactive_kumbaras:e.kumbaras.filter(e=>"inactive"===e.status).length,maintenance_kumbaras:e.kumbaras.filter(e=>"maintenance"===e.status).length,total_collections_today:5,total_amount_today:450.75,total_collections_month:45,total_amount_month:12500.25,top_performing_kumbaras:e.kumbaras.sort((e,a)=>a.totalAmount-e.totalAmount).slice(0,5).map(e=>({id:e.id,name:e.name,location:e.location,amount:e.totalAmount,collections:0})),recent_collections:[],maintenance_alerts:e.kumbaras.filter(e=>"maintenance"===e.status).map(e=>({kumbara_id:e.id,kumbara_name:e.name,issue:e.notes||"Bakım gerekli",priority:"medium"})),performance_trends:[{date:"2024-01-01",total_amount:1e3,collection_count:10},{date:"2024-01-02",total_amount:1200,collection_count:12},{date:"2024-01-03",total_amount:950,collection_count:8}]}}catch(e){throw f.error("Error fetching dashboard stats:",e),new Error("Dashboard istatistikleri alınamadı")}},async getKumbaraAnalytics(e,a,r){try{return{kumbara_id:e,period_start:a,period_end:r,total_collections:25,total_amount:2500.75,average_amount:100.03,collection_frequency:3,performance_score:85,trend:"increasing",peak_months:["Aralık","Ocak"],low_months:["Temmuz","Ağustos"],recommendations:["Koleksiyon sıklığı artırılabilir","QR kod tanıtımı yapılabilir","Lokasyon trafiği incelenmeli"]}}catch(t){throw f.error("Error fetching kumbara analytics:",t),new Error("Kumbara analitikleri alınamadı")}},generateQRData:e=>({kumbaraId:e.id,code:e.code,name:e.name,location:e.location,url:`https://bagis.dernek.org/kumbara/${e.code}`,donationUrl:`https://bagis.dernek.org/donate/kumbara/${e.code}`,contactInfo:{phone:e.phone||"",person:e.contactPerson||""},metadata:{installDate:e.installDate,lastUpdated:e.updated_at,version:"1.0"}}),generatePrintableQR:e=>(I.generateQRData(e),`\n      <html>\n        <head>\n          <title>Kumbara QR Kod - ${e.code}</title>\n          <style>\n            @page { size: 40mm 30mm; margin: 2mm; }\n            body {\n              font-family: Arial, sans-serif;\n              margin: 0;\n              padding: 0;\n              display: flex;\n              flex-direction: column;\n              align-items: center;\n              justify-content: center;\n              height: 26mm;\n              width: 36mm;\n            }\n            .qr-container {\n              text-align: center;\n              border: 1px solid #ddd;\n              padding: 2mm;\n              border-radius: 2mm;\n            }\n            .qr-placeholder {\n              width: 20mm;\n              height: 20mm;\n              border: 2px solid #333;\n              margin: 0 auto 1mm auto;\n              display: flex;\n              align-items: center;\n              justify-content: center;\n              font-size: 8px;\n              background: #f9f9f9;\n            }\n            .qr-info {\n              font-size: 6px;\n              margin: 0;\n              line-height: 1.2;\n            }\n            .qr-code {\n              font-weight: bold;\n              margin-bottom: 0.5mm;\n            }\n          </style>\n        </head>\n        <body>\n          <div class="qr-container">\n            <div class="qr-placeholder">QR KOD</div>\n            <div class="qr-info qr-code">${e.code}</div>\n            <div class="qr-info">${e.name}</div>\n            <div class="qr-info">${e.location}</div>\n          </div>\n        </body>\n      </html>\n    `),validateKumbaraData(e){const a=[];var r;return(!e.name||e.name.trim().length<3)&&a.push("Kumbara adı en az 3 karakter olmalıdır"),(!e.location||e.location.trim().length<3)&&a.push("Lokasyon en az 3 karakter olmalıdır"),(!e.address||e.address.trim().length<10)&&a.push("Adres en az 10 karakter olmalıdır"),e.phone&&(r=e.phone,!/^(\+90|0)?[5][0-9]{9}$/.test(r.replace(/\s/g,"")))&&a.push("Geçerli bir telefon numarası giriniz"),{isValid:0===a.length,errors:a}},async exportKumbaras(e="csv"){try{const a=await I.getKumbaras();if("csv"===e){const e=function(e){return[["Kod","İsim","Lokasyon","Adres","Durum","Kurulum Tarihi","Son Toplama","Toplam Tutar","Aylık Ortalama","İletişim Kişisi","Telefon","Notlar"],...e.map(e=>[e.code,e.name,e.location,e.address,e.status,e.installDate,e.lastCollection||"",e.totalAmount.toString(),e.monthlyAverage.toString(),e.contactPerson||"",e.phone||"",e.notes||""])].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n")}(a.kumbaras);return new Blob([e],{type:"text/csv"})}throw new Error(`${e} formatı henüz desteklenmiyor`)}catch(a){throw f.error("Error exporting kumbaras:",a),new Error("Kumbara verileri dışa aktarılamadı")}},async getKumbaraAlerts(){try{return[{id:"1",kumbara_id:"3",alert_type:"maintenance_due",severity:"warning",title:"Bakım Gerekli",message:"Market Kumbarası kilit arızası nedeniyle bakım gerektiriyor",action_required:!0,action_url:"/kumbara/3/maintenance",acknowledged:!1,resolved:!1,created_at:(new Date).toISOString()}]}catch(e){throw f.error("Error fetching kumbara alerts:",e),new Error("Kumbara uyarıları alınamadı")}},async acknowledgeAlert(e,a){try{return!0}catch(r){throw f.error("Error acknowledging alert:",r),new Error("Uyarı onaylanamadı")}}};export{r as default};
