function e(){const e=p(),[R,Y]=a.useState(""),[L,V]=a.useState("all"),[I,K]=a.useState("all"),[H,J]=a.useState(!1),[Q,U]=a.useState(!1),[W,Z]=a.useState([]),[ee,ae]=a.useState({student_name:"",email:"",phone:"",school:"",grade:"",program:"",scholarship_amount:0,gpa:0,notes:""}),le=a.useCallback(async()=>{try{const e=(await f.getAidRequests(1,1e3,{aidType:"education"})).data.map(se);Z(e)}catch(e){b.error("Failed to load students",e),h.error("Öğrenciler yüklenirken hata oluştu")}},[]);a.useEffect(()=>{le()},[le]);const se=e=>{const a=e.description.split(" - "),l=a[0]??"",s=a[1]??"",r=a[2]??"",t=a.find(e=>e.startsWith("GPA:"))??"GPA: 0",i=parseFloat(t.replace("GPA: ",""))||0;return{id:e.$id,name:e.applicant_name,email:e.applicant_email??"",phone:e.applicant_phone??"",school:l,grade:s,program:r,scholarshipAmount:e.requested_amount??0,status:{approved:"active",completed:"graduated",rejected:"dropped",pending:"suspended",under_review:"suspended"}[e.status]??"active",startDate:e.$createdAt,gpa:i,avatar:void 0}},re=a.useMemo(()=>({total:W.length,active:W.filter(e=>"active"===e.status).length,graduated:W.filter(e=>"graduated"===e.status).length,totalAmount:W.filter(e=>"active"===e.status).reduce((e,a)=>e+a.scholarshipAmount,0)}),[W]),te=a.useMemo(()=>W.filter(e=>{const a=e.name.toLowerCase().includes(R.toLowerCase())||e.school.toLowerCase().includes(R.toLowerCase())||e.program.toLowerCase().includes(R.toLowerCase()),l="all"===L||e.status===L,s="all"===I||e.program===I;return a&&l&&s}),[W,R,L,I]),ie=e=>{h.success(`Öğrenci detayları açılıyor: ${e}`)},ne=[...new Set(W.map(e=>e.program))];return l.jsxs("div",{className:"safe-area min-h-full space-y-6 bg-slate-50/50 p-3 sm:p-6 lg:space-y-8 lg:p-8",children:[l.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[l.jsxs("div",{className:"space-y-1 sm:space-y-2",children:[l.jsxs("h1",{className:"flex items-center gap-3 text-2xl font-bold text-slate-800 sm:text-3xl",children:[l.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-xl bg-gradient-to-br from-amber-600 to-orange-700 sm:h-10 sm:w-10",children:l.jsx(s,{className:"h-5 w-5 text-white sm:h-6 sm:w-6"})}),"Burs Öğrencileri"]}),l.jsx("p",{className:"text-sm text-slate-600 sm:text-base",children:"Burslu öğrencileri yönetin ve takip edin"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs(w,{onClick:()=>{h.success("Toplu işlem menüsü açılıyor...")},variant:"outline",size:"sm",className:"hidden sm:flex",children:[l.jsx(r,{className:"mr-2 h-4 w-4"}),"Raporlar"]}),l.jsxs(w,{onClick:()=>{J(!0)},size:"sm",children:[l.jsx(t,{className:"mr-2 h-4 w-4"}),"Yeni Öğrenci"]})]})]}),l.jsxs(u,{cols:{default:2,sm:4},gap:"sm",children:[l.jsx(v,{icon:l.jsx(i,{className:"h-5 w-5"}),title:"Toplam Öğrenci",value:re.total.toString(),color:"text-blue-600"}),l.jsx(v,{icon:l.jsx(n,{className:"h-5 w-5"}),title:"Aktif Öğrenci",value:re.active.toString(),color:"text-green-600"}),l.jsx(v,{icon:l.jsx(c,{className:"h-5 w-5"}),title:"Mezun Sayısı",value:re.graduated.toString(),color:"text-purple-600"}),l.jsx(v,{icon:l.jsx(d,{className:"h-5 w-5"}),title:"Aylık Toplam",value:`₺${re.totalAmount.toLocaleString()}`,color:"text-amber-600"})]}),l.jsx(k,{children:l.jsx(_,{className:"p-4 sm:p-6",children:l.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[l.jsx("div",{className:"sm:col-span-2 lg:col-span-2",children:l.jsxs("div",{className:"relative",children:[l.jsx(o,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-slate-400"}),l.jsx(C,{placeholder:"Burslu öğrenci, okul veya program ara...",value:R,onChange:e=>{Y(e.target.value)},className:"pl-10"})]})}),l.jsxs(j,{value:L,onValueChange:V,children:[l.jsx(A,{children:l.jsx(B,{placeholder:"Durum Filtresi"})}),l.jsxs(F,{children:[l.jsx(T,{value:"all",children:"Tüm Durumlar"}),l.jsx(T,{value:"active",children:"Aktif"}),l.jsx(T,{value:"graduated",children:"Mezun"}),l.jsx(T,{value:"dropped",children:"Bırakmış"}),l.jsx(T,{value:"suspended",children:"Askıda"})]})]}),l.jsxs(j,{value:I,onValueChange:K,children:[l.jsx(A,{children:l.jsx(B,{placeholder:"Program Filtresi"})}),l.jsxs(F,{children:[l.jsx(T,{value:"all",children:"Tüm Programlar"}),ne.map(e=>l.jsx(T,{value:e,children:e},e))]})]})]})})}),l.jsxs(k,{children:[l.jsx(P,{className:"pb-4",children:l.jsxs(X,{className:"flex items-center justify-between",children:[l.jsx("span",{children:"Öğrenci Listesi"}),l.jsxs($,{variant:"secondary",className:"text-xs",children:[te.length," öğrenci"]})]})}),l.jsx(_,{className:"p-0 sm:p-6 sm:pt-0",children:e?l.jsx("div",{className:"space-y-3 p-4",children:te.map((e,a)=>l.jsx("div",{children:l.jsx(g,{icon:l.jsx(s,{className:"h-5 w-5"}),title:e.name,description:`${e.program} • ${e.school}`,onClick:()=>{ie(e.id)},variant:"secondary"})},e.id))}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-slate-200",children:[l.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Öğrenci"}),l.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Okul"}),l.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Program"}),l.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Burs"}),l.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"GPA"}),l.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Durum"}),l.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"İşlemler"})]})}),l.jsx("tbody",{children:te.map((e,a)=>{const s={active:{label:"Aktif",variant:"default",color:"bg-green-500"},graduated:{label:"Mezun",variant:"secondary",color:"bg-blue-500"},dropped:{label:"Bırakmış",variant:"destructive",color:"bg-gray-500"},suspended:{label:"Askıda",variant:"outline",color:"bg-yellow-500"}}[e.status];return l.jsxs(E.tr,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*a},className:"border-b border-slate-100 transition-colors hover:bg-slate-50",children:[l.jsx("td",{className:"px-4 py-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs(x,{className:"h-10 w-10",children:[l.jsx(y,{src:e.avatar}),l.jsx(N,{className:"bg-gradient-to-br from-amber-600 to-orange-700 text-white",children:e.name.split(" ").map(e=>e[0]).join("")})]}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium text-slate-900",children:e.name}),l.jsx("div",{className:"text-sm text-slate-500",children:e.grade})]})]})}),l.jsx("td",{className:"px-4 py-4 text-slate-700",children:e.school}),l.jsx("td",{className:"px-4 py-4 text-slate-700",children:e.program}),l.jsx("td",{className:"px-4 py-4",children:l.jsxs("span",{className:"font-semibold text-green-600",children:["₺",e.scholarshipAmount.toLocaleString()]})}),l.jsx("td",{className:"px-4 py-4",children:l.jsx("span",{className:"font-medium "+(e.gpa>=3.5?"text-green-600":e.gpa>=3?"text-amber-600":"text-red-600"),children:e.gpa.toFixed(2)})}),l.jsx("td",{className:"px-4 py-4",children:l.jsx($,{variant:s.variant,children:s.label})}),l.jsx("td",{className:"px-4 py-4",children:l.jsx(w,{variant:"ghost",size:"sm",onClick:()=>{ie(e.id)},children:l.jsx(m,{className:"h-4 w-4"})})})]},e.id)})})]})})})]}),l.jsx(z,{open:H,onOpenChange:J,children:l.jsxs(S,{className:"max-h-[90vh] overflow-y-auto sm:max-w-[600px]",children:[l.jsxs(q,{children:[l.jsxs(G,{className:"flex items-center gap-2",children:[l.jsx(s,{className:"h-5 w-5"}),"Yeni Burs Başvurusu"]}),l.jsx(M,{children:"Öğrenci bilgilerini doldurun ve burs başvurusunu oluşturun."})]}),l.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!ee.student_name||!ee.email||!ee.school)return h.error("Öğrenci adı, e-posta ve okul alanları zorunludur"),void 0;try{U(!0);const e=await f.createAidRequest({applicant_name:ee.student_name,applicant_email:ee.email,applicant_phone:ee.phone,applicant_address:ee.school,aid_type:"education",requested_amount:ee.scholarship_amount,currency:"TRY",urgency:"medium",description:`${ee.school} - ${ee.grade} - ${ee.program} - GPA: ${ee.gpa} - ${ee.notes}`,reason:"Scholarship application",status:"pending",follow_up_required:!0,created_by:"system"});e.error?(b.error("Failed to create scholarship application",e.error),h.error("Başvuru oluşturulurken hata oluştu")):(h.success("Burs başvurusu başarıyla oluşturuldu!"),J(!1),ae({student_name:"",email:"",phone:"",school:"",grade:"",program:"",scholarship_amount:0,gpa:0,notes:""}),le())}catch(a){b.error("Error submitting application",a),h.error("Başvuru oluşturulurken hata oluştu")}finally{U(!1)}},className:"space-y-4 py-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsxs(O,{htmlFor:"student_name",children:["Öğrenci Adı ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx(C,{id:"student_name",value:ee.student_name,onChange:e=>{ae({...ee,student_name:e.target.value})},placeholder:"Öğrencinin tam adı",required:!0})]}),l.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsxs(O,{htmlFor:"email",children:["E-posta ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx(C,{id:"email",type:"email",value:ee.email,onChange:e=>{ae({...ee,email:e.target.value})},placeholder:"ogrenci@email.com",required:!0})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(O,{htmlFor:"phone",children:"Telefon"}),l.jsx(C,{id:"phone",type:"tel",value:ee.phone,onChange:e=>{ae({...ee,phone:e.target.value})},placeholder:"05XX XXX XX XX"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs(O,{htmlFor:"school",children:["Okul ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx(C,{id:"school",value:ee.school,onChange:e=>{ae({...ee,school:e.target.value})},placeholder:"Üniversite veya okul adı",required:!0})]}),l.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(O,{htmlFor:"grade",children:"Sınıf"}),l.jsx(C,{id:"grade",value:ee.grade,onChange:e=>{ae({...ee,grade:e.target.value})},placeholder:"Örn: 3. Sınıf"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(O,{htmlFor:"program",children:"Bölüm"}),l.jsx(C,{id:"program",value:ee.program,onChange:e=>{ae({...ee,program:e.target.value})},placeholder:"Örn: Bilgisayar Mühendisliği"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(O,{htmlFor:"scholarship_amount",children:"Burs Tutarı (TL)"}),l.jsx(C,{id:"scholarship_amount",type:"number",value:ee.scholarship_amount||"",onChange:e=>{ae({...ee,scholarship_amount:parseFloat(e.target.value)||0})},placeholder:"1500",min:"0"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(O,{htmlFor:"gpa",children:"Not Ortalaması (GPA)"}),l.jsx(C,{id:"gpa",type:"number",step:"0.01",value:ee.gpa||"",onChange:e=>{ae({...ee,gpa:parseFloat(e.target.value)||0})},placeholder:"3.45",min:"0",max:"4"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(O,{htmlFor:"notes",children:"Notlar"}),l.jsx(D,{id:"notes",value:ee.notes,onChange:e=>{ae({...ee,notes:e.target.value})},placeholder:"Ek bilgiler ve notlar",rows:3})]}),l.jsxs("div",{className:"flex justify-end gap-2 border-t pt-4",children:[l.jsx(w,{type:"button",variant:"outline",onClick:()=>{J(!1)},disabled:Q,children:"İptal"}),l.jsx(w,{type:"submit",disabled:Q,children:Q?"Kaydediliyor...":"Başvuru Oluştur"})]})]})]})})]})}import{r as a,j as l,ac as s,a5 as r,aa as t,c5 as i,c6 as n,a1 as c,a9 as d,l as o,E as m}from"./react-vendor-Zi_jsHoK.js";import{t as h}from"./toast-vendor-Ci27VDWJ.js";import{u as p,R as u,M as v,T as g}from"./events-finance-page-DWyC3OLf.js";import{A as x,a as y,b as N}from"./messaging-page-BEU6nUaR.js";import{a1 as f,l as b,B as w,C as k,e as _,I as C,S as j,j as A,k as B,m as F,n as T,a as P,b as X,f as $,o as z,p as S,q,r as G,s as M,t as O,v as D}from"./beneficiaries-page-CkZlrYV8.js";import{m as E}from"./motion-vendor-iBxafAnt.js";import"./ui-vendor-f6_gbUtQ.js";import"./utils-vendor-CH-VcvGo.js";import"./appwrite-vendor-Ct7vfU_L.js";export{e as BursStudentsPage,e as default};
