import{r as i,a4 as e,j as a,X as r,K as n,bJ as s,ae as t,L as l,aK as c,bK as o}from"./react-vendor-Zi_jsHoK.js";import{t as d}from"./toast-vendor-Ci27VDWJ.js";import{l as u,f as h,C as m,a as b,b as f,e as p,c as y,B as g,t as v,I as N,v as w}from"./beneficiaries-page-CkZlrYV8.js";import{A as k,f as B}from"./user-management-page-B6-AaFFc.js";import{S as j}from"./switch-C3esbnVh.js";import{T as C,a as F,b as P,c as x}from"./tabs-fYszpb1R.js";import"./ui-vendor-f6_gbUtQ.js";import"./utils-vendor-CH-VcvGo.js";import"./appwrite-vendor-Ct7vfU_L.js";import"./motion-vendor-iBxafAnt.js";import"./messaging-page-BEU6nUaR.js";import"./events-finance-page-DWyC3OLf.js";const S=new class{subscribed=!1;async initialize(){return!0}isSubscribed(){return this.subscribed}getPermissionStatus(){return"undefined"!=typeof Notification?Notification.permission:"default"}async subscribe(){return this.subscribed=!0,!0}async unsubscribe(){return this.subscribed=!1,!0}async showNotification(i){"undefined"!=typeof Notification&&"granted"===Notification.permission&&new Notification(i.title,{body:i.body||"",icon:i.icon||""})}async sendNotificationToUser(i,e){return!0}async broadcastNotification(i){return!0}},T=e.memo(({className:e=""})=>{const{isSupported:T,isSubscribed:K,permission:z,isLoading:E,error:I,subscribe:q,unsubscribe:G,showNotification:L,sendToUser:D,broadcast:A}=(()=>{const[e,a]=i.useState(!1),[r,n]=i.useState(!1),[s,t]=i.useState("default"),[l,c]=i.useState(!0),[o,d]=i.useState(null);return i.useEffect(()=>{(async()=>{try{c(!0),d(null);const i="serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window;if(a(i),!i)return d("Push notifications are not supported in this browser"),void 0;const e=await S.initialize();n(S.isSubscribed()),t(S.getPermissionStatus()),u.info("Push notification service initialized:",e)}catch(i){d(i instanceof Error?i.message:"Failed to initialize push notifications"),u.error("Push notification initialization error:",i)}finally{c(!1)}})();const i=()=>{t(Notification.permission)};"permissions"in navigator&&navigator.permissions.query({name:"notifications"}).then(e=>(e.addEventListener("change",i),()=>{e.removeEventListener("change",i)}))},[]),{isSupported:e,isSubscribed:r,permission:s,isLoading:l,error:o,subscribe:i.useCallback(async()=>{try{c(!0),d(null);const i=await S.subscribe();return n(i),t(S.getPermissionStatus()),i||d("Failed to subscribe to push notifications"),i}catch(i){const e=i instanceof Error?i.message:"Failed to subscribe";return d(e),u.error("Push notification subscription error:",i),!1}finally{c(!1)}},[]),unsubscribe:i.useCallback(async()=>{try{c(!0),d(null);const i=await S.unsubscribe();return n(!i),i||d("Failed to unsubscribe from push notifications"),i}catch(i){const e=i instanceof Error?i.message:"Failed to unsubscribe";return d(e),u.error("Push notification unsubscription error:",i),!1}finally{c(!1)}},[]),showNotification:i.useCallback(async i=>{try{d(null),await S.showNotification(i)}catch(e){const i=e instanceof Error?e.message:"Failed to show notification";throw d(i),u.error("Show notification error:",e),e}},[]),sendToUser:i.useCallback(async(i,e)=>{try{return d(null),await S.sendNotificationToUser(i,e)}catch(a){const i=a instanceof Error?a.message:"Failed to send notification";return d(i),u.error("Send notification error:",a),!1}},[]),broadcast:i.useCallback(async i=>{try{return d(null),await S.broadcastNotification(i)}catch(e){const i=e instanceof Error?e.message:"Failed to broadcast notification";return d(i),u.error("Broadcast notification error:",e),!1}},[])}})(),[M,U]=i.useState({title:"Test Bildirimi",body:"Bu bir test bildirimidir.",requireInteraction:!1}),[H,V]=i.useState(""),[$,J]=i.useState({title:"Sistem Bildirimi",body:"",requireInteraction:!0}),R=i.useCallback(async()=>{await q()?d.success("Push bildirimleri başarıyla etkinleştirildi."):d.error("Push bildirimleri etkinleştirilemedi.")},[q]),W=i.useCallback(async()=>{await G()?d.success("Push bildirimleri başarıyla kapatıldı."):d.error("Bildirimler kapatılamadı.")},[G]),Y=i.useCallback(async()=>{try{await L({title:M.title,body:M.body,icon:"/favicon.svg"}),d.success("Test bildirimi başarıyla gönderildi.")}catch{d.error("Test bildirimi gönderilirken hata oluştu.")}},[L,M]),O=i.useCallback(async()=>{if(!H.trim())return d.error("Lütfen geçerli bir kullanıcı ID girin."),void 0;await D(H,{title:"Kişisel Bildirim",body:`Size özel bir mesaj: ${M.body}`,icon:"/favicon.svg"})?d.success(`${H} kullanıcısına bildirim gönderildi.`):d.error("Kullanıcıya bildirim gönderilirken hata oluştu.")},[D,H,M.body]),Q=i.useCallback(async()=>{if(!$.body.trim())return d.error("Lütfen broadcast mesajı girin."),void 0;await A({title:$.title,body:$.body,icon:"/favicon.svg"})?(d.success("Tüm kullanıcılara bildirim gönderildi."),J(i=>({...i,body:""}))):d.error("Broadcast gönderilirken hata oluştu.")},[A,$,J]),X=i.useMemo(()=>{switch(z){case"granted":return a.jsxs(h,{variant:"default",className:"bg-green-500",children:[a.jsx(n,{className:"w-3 h-3 mr-1"}),"İzin Verildi"]});case"denied":return a.jsxs(h,{variant:"destructive",children:[a.jsx(r,{className:"w-3 h-3 mr-1"}),"İzin Reddedildi"]});default:return a.jsx(h,{variant:"secondary",children:"İzin Bekleniyor"})}},[z]);return T?a.jsxs(m,{className:e,children:[a.jsxs(b,{children:[a.jsxs(f,{className:"flex items-center gap-2",children:[a.jsx(t,{className:"w-5 h-5"}),"Push Bildirim Yönetimi"]}),a.jsx(y,{children:"Kullanıcılara anlık bildirimler gönderin ve bildirim ayarlarını yönetin."})]}),a.jsxs(p,{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium",children:"Durum:"}),X]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium",children:"Abonelik:"}),a.jsx(h,{variant:K?"default":"secondary",children:K?"Aktif":"Pasif"})]})]}),a.jsx("div",{className:"space-x-2",children:K?a.jsxs(g,{onClick:W,variant:"outline",disabled:E,className:"gap-2",children:[E?a.jsx(l,{className:"w-4 h-4 animate-spin"}):a.jsx(s,{className:"w-4 h-4"}),"Bildirimleri Kapat"]}):a.jsxs(g,{onClick:R,disabled:E??"denied"===z,className:"gap-2",children:[E?a.jsx(l,{className:"w-4 h-4 animate-spin"}):a.jsx(t,{className:"w-4 h-4"}),"Bildirimleri Etkinleştir"]})})]}),I&&a.jsxs(k,{variant:"destructive",children:[a.jsx(r,{className:"w-4 h-4"}),a.jsx(B,{children:I})]}),K&&a.jsxs(C,{defaultValue:"test",className:"w-full",children:[a.jsxs(F,{className:"grid w-full grid-cols-3",children:[a.jsx(P,{value:"test",children:"Test"}),a.jsx(P,{value:"user",children:"Kullanıcıya Gönder"}),a.jsx(P,{value:"broadcast",children:"Broadcast"})]}),a.jsx(x,{value:"test",className:"space-y-4",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(v,{htmlFor:"test-title",children:"Başlık"}),a.jsx(N,{id:"test-title",value:M.title,onChange:i=>{U(e=>({...e,title:i.target.value}))},placeholder:"Bildirim başlığı"})]}),a.jsxs("div",{children:[a.jsx(v,{htmlFor:"test-body",children:"Mesaj"}),a.jsx(w,{id:"test-body",value:M.body,onChange:i=>{U(e=>({...e,body:i.target.value}))},placeholder:"Bildirim mesajı",rows:3})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(j,{id:"require-interaction",checked:M.requireInteraction,onCheckedChange:i=>{U(e=>({...e,requireInteraction:i}))}}),a.jsx(v,{htmlFor:"require-interaction",children:"Etkileşim Gerektir"})]}),a.jsxs(g,{onClick:Y,className:"w-full gap-2",children:[a.jsx(c,{className:"w-4 h-4"}),"Test Bildirimi Gönder"]})]})}),a.jsx(x,{value:"user",className:"space-y-4",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(v,{htmlFor:"target-user",children:"Kullanıcı ID"}),a.jsx(N,{id:"target-user",value:H,onChange:i=>{V(i.target.value)},placeholder:"Hedef kullanıcı ID"})]}),a.jsxs(g,{onClick:O,className:"w-full gap-2",children:[a.jsx(c,{className:"w-4 h-4"}),"Kullanıcıya Gönder"]})]})}),a.jsx(x,{value:"broadcast",className:"space-y-4",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(v,{htmlFor:"broadcast-title",children:"Başlık"}),a.jsx(N,{id:"broadcast-title",value:$.title,onChange:i=>{J(e=>({...e,title:i.target.value}))},placeholder:"Broadcast başlığı"})]}),a.jsxs("div",{children:[a.jsx(v,{htmlFor:"broadcast-body",children:"Mesaj"}),a.jsx(w,{id:"broadcast-body",value:$.body,onChange:i=>{J(e=>({...e,body:i.target.value}))},placeholder:"Tüm kullanıcılara gönderilecek mesaj",rows:3})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(j,{id:"broadcast-interaction",checked:$.requireInteraction,onCheckedChange:i=>{J(e=>({...e,requireInteraction:i}))}}),a.jsx(v,{htmlFor:"broadcast-interaction",children:"Etkileşim Gerektir"})]}),a.jsxs(g,{onClick:Q,className:"w-full gap-2",variant:"destructive",children:[a.jsx(o,{className:"w-4 h-4"}),"Herkese Gönder"]})]})})]})]})]}):a.jsxs(m,{className:e,children:[a.jsx(b,{children:a.jsxs(f,{className:"flex items-center gap-2",children:[a.jsx(s,{className:"w-5 h-5"}),"Push Bildirimleri"]})}),a.jsx(p,{children:a.jsxs(k,{children:[a.jsx(s,{className:"w-4 h-4"}),a.jsx(B,{children:"Bu tarayıcı push bildirimleri desteklemiyor."})]})})]})});export{T as default};
