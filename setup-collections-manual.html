<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Appwrite Collection Setup - Manuel Kurulum</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #007bff;
            padding-bottom: 10px;
        }
        .step {
            background: #f8f9fa;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        .step h3 {
            margin-top: 0;
            color: #007bff;
        }
        .collection {
            background: #e9ecef;
            padding: 15px;
            margin: 10px 0;
            border-radius: 6px;
            border: 1px solid #dee2e6;
        }
        .collection h4 {
            margin: 0 0 10px 0;
            color: #495057;
        }
        .attributes {
            font-size: 0.9em;
            color: #6c757d;
        }
        .attributes ul {
            margin: 5px 0;
            padding-left: 20px;
        }
        .btn {
            background: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            margin: 10px 5px;
        }
        .btn:hover {
            background: #0056b3;
        }
        .btn-success {
            background: #28a745;
        }
        .btn-success:hover {
            background: #1e7e34;
        }
        .alert {
            padding: 15px;
            margin: 20px 0;
            border-radius: 6px;
            border: 1px solid transparent;
        }
        .alert-info {
            background: #d1ecf1;
            border-color: #bee5eb;
            color: #0c5460;
        }
        .alert-warning {
            background: #fff3cd;
            border-color: #ffeaa7;
            color: #856404;
        }
        .alert-success {
            background: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        .json-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
        }
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        .status-completed {
            background: #d4edda;
            color: #155724;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🗄️ Appwrite Collection Setup - Manuel Kurulum</h1>
        
        <div class="alert alert-info">
            <strong>📋 Bilgi:</strong> Bu sayfa, Appwrite Console'da collection'ları manuel olarak oluşturmak için gerekli bilgileri içerir.
        </div>

        <div class="alert alert-warning">
            <strong>⚠️ Önemli:</strong> Collection'ları oluşturmak için Appwrite Console'a admin erişimi gereklidir.
        </div>

        <h2>📊 Mevcut Durum</h2>
        <div class="step">
            <h3>✅ Tamamlanan İşlemler</h3>
            <ul>
                <li>✅ Users API - 6 kullanıcı mevcut</li>
                <li>✅ Authentication sistemi çalışıyor</li>
                <li>✅ User roles ve permissions tanımlandı</li>
            </ul>
        </div>

        <div class="step">
            <h3>❌ Eksik Collection'lar</h3>
            <p>Aşağıdaki collection'lar <code>appwrite.json</code>'da tanımlandı ama Appwrite'da oluşturulmadı:</p>
            <ul>
                <li><span class="status status-pending">users</span> - Kullanıcı yönetimi</li>
                <li><span class="status status-pending">user_activities</span> - Kullanıcı aktiviteleri</li>
                <li><span class="status status-pending">workflows</span> - İş akışları</li>
                <li><span class="status status-pending">automation_rules</span> - Otomasyon kuralları</li>
                <li><span class="status status-pending">beneficiaries</span> - İhtiyaç sahipleri</li>
                <li><span class="status status-pending">donations</span> - Bağışlar</li>
                <li><span class="status status-pending">aid_applications</span> - Yardım başvuruları</li>
                <li><span class="status status-pending">members</span> - Üyeler</li>
            </ul>
        </div>

        <h2>🔧 Manuel Kurulum Adımları</h2>

        <div class="step">
            <h3>1. Appwrite Console'a Giriş</h3>
            <p>Appwrite Console'a giriş yapın:</p>
            <a href="https://cloud.appwrite.io/console" target="_blank" class="btn">Appwrite Console'a Git</a>
            
            <p><strong>Proje Bilgileri:</strong></p>
            <ul>
                <li><strong>Project ID:</strong> <code>68e99f6c000183bafb39</code></li>
                <li><strong>Database ID:</strong> <code>kafkasder_db</code></li>
                <li><strong>Endpoint:</strong> <code>https://fra.cloud.appwrite.io/v1</code></li>
            </ul>
        </div>

        <div class="step">
            <h3>2. Database'e Git</h3>
            <p>Console'da şu adımları izleyin:</p>
            <ol>
                <li>Sol menüden <strong>"Databases"</strong> seçin</li>
                <li><strong>"kafkasder_db"</strong> database'ini seçin</li>
                <li><strong>"Collections"</strong> sekmesine tıklayın</li>
                <li><strong>"Create Collection"</strong> butonuna tıklayın</li>
            </ol>
        </div>

        <div class="step">
            <h3>3. Collection'ları Oluştur</h3>
            <p>Aşağıdaki her collection için <strong>"Create Collection"</strong> butonuna tıklayıp bilgileri girin:</p>

            <div class="collection">
                <h4>👤 Users Collection</h4>
                <p><strong>Collection ID:</strong> <code>users</code></p>
                <p><strong>Name:</strong> <code>Users</code></p>
                <p><strong>Document Security:</strong> ✅ Enabled</p>
                <p><strong>Permissions:</strong></p>
                <ul>
                    <li><code>read("any")</code></li>
                    <li><code>create("users")</code></li>
                    <li><code>update("users")</code></li>
                    <li><code>delete("users")</code></li>
                </ul>
                <div class="attributes">
                    <strong>Attributes:</strong>
                    <ul>
                        <li><code>name</code> (string, 255, required)</li>
                        <li><code>email</code> (string, 255, required)</li>
                        <li><code>phone</code> (string, 20, optional)</li>
                        <li><code>role</code> (string, 50, required, default: "viewer")</li>
                        <li><code>status</code> (string, 50, required, default: "active")</li>
                        <li><code>department</code> (string, 100, optional)</li>
                        <li><code>permissions</code> (string array, 1000, optional)</li>
                        <li><code>avatar</code> (string, 500, optional)</li>
                        <li><code>last_login</code> (datetime, optional)</li>
                        <li><code>created_by</code> (string, 255, optional)</li>
                        <li><code>deleted_at</code> (datetime, optional)</li>
                        <li><code>password_reset_required</code> (boolean, optional, default: false)</li>
                        <li><code>password_reset_token</code> (string, 255, optional)</li>
                    </ul>
                    <strong>Indexes:</strong>
                    <ul>
                        <li><code>email_index</code> (unique, email)</li>
                        <li><code>role_index</code> (key, role)</li>
                        <li><code>status_index</code> (key, status)</li>
                        <li><code>created_at_index</code> (key, $createdAt)</li>
                    </ul>
                </div>
            </div>

            <div class="collection">
                <h4>📊 User Activities Collection</h4>
                <p><strong>Collection ID:</strong> <code>user_activities</code></p>
                <p><strong>Name:</strong> <code>User Activities</code></p>
                <p><strong>Document Security:</strong> ✅ Enabled</p>
                <p><strong>Permissions:</strong></p>
                <ul>
                    <li><code>read("any")</code></li>
                    <li><code>create("users")</code></li>
                    <li><code>update("users")</code></li>
                    <li><code>delete("users")</code></li>
                </ul>
                <div class="attributes">
                    <strong>Attributes:</strong>
                    <ul>
                        <li><code>user_id</code> (string, 255, required)</li>
                        <li><code>action</code> (string, 100, required)</li>
                        <li><code>description</code> (string, 500, optional)</li>
                        <li><code>ip_address</code> (string, 45, optional)</li>
                        <li><code>user_agent</code> (string, 1000, optional)</li>
                        <li><code>metadata</code> (string, 2000, optional, default: "{}")</li>
                    </ul>
                    <strong>Indexes:</strong>
                    <ul>
                        <li><code>user_id_index</code> (key, user_id)</li>
                        <li><code>action_index</code> (key, action)</li>
                        <li><code>created_at_index</code> (key, $createdAt)</li>
                    </ul>
                </div>
            </div>

            <div class="collection">
                <h4>⚙️ Workflows Collection</h4>
                <p><strong>Collection ID:</strong> <code>workflows</code></p>
                <p><strong>Name:</strong> <code>Workflows</code></p>
                <p><strong>Document Security:</strong> ✅ Enabled</p>
                <p><strong>Permissions:</strong></p>
                <ul>
                    <li><code>read("any")</code></li>
                    <li><code>create("users")</code></li>
                    <li><code>update("users")</code></li>
                    <li><code>delete("users")</code></li>
                </ul>
                <div class="attributes">
                    <strong>Attributes:</strong>
                    <ul>
                        <li><code>name</code> (string, 255, required)</li>
                        <li><code>description</code> (string, 1000, optional)</li>
                        <li><code>status</code> (string, 50, required, default: "inactive")</li>
                        <li><code>trigger_type</code> (string, 100, required)</li>
                        <li><code>trigger_conditions</code> (string, 2000, optional, default: "{}")</li>
                        <li><code>steps</code> (string, 5000, required, default: "[]")</li>
                        <li><code>last_run</code> (datetime, optional)</li>
                        <li><code>next_run</code> (datetime, optional)</li>
                        <li><code>success_rate</code> (integer, optional, default: 0)</li>
                        <li><code>created_by</code> (string, 255, optional)</li>
                    </ul>
                    <strong>Indexes:</strong>
                    <ul>
                        <li><code>status_index</code> (key, status)</li>
                        <li><code>trigger_type_index</code> (key, trigger_type)</li>
                        <li><code>created_at_index</code> (key, $createdAt)</li>
                    </ul>
                </div>
            </div>

            <div class="collection">
                <h4>🤖 Automation Rules Collection</h4>
                <p><strong>Collection ID:</strong> <code>automation_rules</code></p>
                <p><strong>Name:</strong> <code>Automation Rules</code></p>
                <p><strong>Document Security:</strong> ✅ Enabled</p>
                <p><strong>Permissions:</strong></p>
                <ul>
                    <li><code>read("any")</code></li>
                    <li><code>create("users")</code></li>
                    <li><code>update("users")</code></li>
                    <li><code>delete("users")</code></li>
                </ul>
                <div class="attributes">
                    <strong>Attributes:</strong>
                    <ul>
                        <li><code>name</code> (string, 255, required)</li>
                        <li><code>description</code> (string, 1000, optional)</li>
                        <li><code>is_active</code> (boolean, required, default: true)</li>
                        <li><code>rule_type</code> (string, 100, required)</li>
                        <li><code>conditions</code> (string, 2000, required, default: "{}")</li>
                        <li><code>actions</code> (string, 2000, required, default: "[]")</li>
                        <li><code>priority</code> (integer, optional, default: 0)</li>
                        <li><code>created_by</code> (string, 255, optional)</li>
                    </ul>
                    <strong>Indexes:</strong>
                    <ul>
                        <li><code>is_active_index</code> (key, is_active)</li>
                        <li><code>rule_type_index</code> (key, rule_type)</li>
                        <li><code>priority_index</code> (key, priority)</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="step">
            <h3>4. Test Et</h3>
            <p>Collection'lar oluşturulduktan sonra test etmek için:</p>
            <button class="btn btn-success" onclick="testCollections()">🧪 Collection'ları Test Et</button>
            <div id="test-results" style="margin-top: 20px;"></div>
        </div>

        <div class="step">
            <h3>5. Sonraki Adımlar</h3>
            <p>Collection'lar oluşturulduktan sonra:</p>
            <ol>
                <li>✅ Email/SMS Service implementasyonu</li>
                <li>✅ Security Middleware JWT validation</li>
                <li>✅ Analytics Dashboard gerçek veriler</li>
                <li>✅ Recent Activity gerçek veriler</li>
            </ol>
        </div>

        <div class="alert alert-success">
            <strong>🎉 Tebrikler!</strong> Collection'lar oluşturulduktan sonra uygulama tamamen fonksiyonel olacak!
        </div>
    </div>

    <script>
        async function testCollections() {
            const resultsDiv = document.getElementById('test-results');
            resultsDiv.innerHTML = '<div class="alert alert-info">🔄 Collection\'lar test ediliyor...</div>';
            
            try {
                // Bu fonksiyon collection'lar oluşturulduktan sonra çalışacak
                const response = await fetch('/api/test-collections');
                
                if (response.ok) {
                    resultsDiv.innerHTML = '<div class="alert alert-success">✅ Tüm collection\'lar başarıyla test edildi!</div>';
                } else {
                    resultsDiv.innerHTML = '<div class="alert alert-warning">⚠️ Bazı collection\'lar henüz oluşturulmamış olabilir.</div>';
                }
            } catch (error) {
                resultsDiv.innerHTML = '<div class="alert alert-warning">⚠️ Test edilemedi. Collection\'ları manuel olarak kontrol edin.</div>';
            }
        }
    </script>
</body>
</html>
