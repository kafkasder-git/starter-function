<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email/SMS Service Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #28a745;
            padding-bottom: 10px;
        }
        .test-section {
            background: #f8f9fa;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid #28a745;
        }
        .test-section h3 {
            margin-top: 0;
            color: #28a745;
        }
        .form-group {
            margin: 15px 0;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        input, textarea, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        textarea {
            height: 100px;
            resize: vertical;
        }
        .btn {
            background: #28a745;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        .btn:hover {
            background: #218838;
        }
        .btn-secondary {
            background: #6c757d;
        }
        .btn-secondary:hover {
            background: #545b62;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid transparent;
        }
        .result.success {
            background: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        .result.error {
            background: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
        .result.info {
            background: #d1ecf1;
            border-color: #bee5eb;
            color: #0c5460;
        }
        .template-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        .template-card {
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .template-card:hover {
            border-color: #28a745;
            background: #f8f9fa;
        }
        .template-card.selected {
            border-color: #28a745;
            background: #e8f5e8;
        }
        .template-card h4 {
            margin: 0 0 10px 0;
            color: #28a745;
        }
        .template-card p {
            margin: 0;
            color: #666;
            font-size: 0.9em;
        }
        .variables {
            background: #e9ecef;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
        }
        .variables h5 {
            margin: 0 0 10px 0;
            color: #495057;
        }
        .variables input {
            margin: 5px 0;
        }
        .bulk-section {
            background: #fff3cd;
            border-color: #ffeaa7;
            color: #856404;
        }
        .bulk-section h3 {
            color: #856404;
        }
        .recipients-list {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            background: white;
        }
        .recipient-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 0;
            border-bottom: 1px solid #eee;
        }
        .recipient-item:last-child {
            border-bottom: none;
        }
        .remove-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 2px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>📧 Email/SMS Service Test</h1>
        
        <div class="test-section">
            <h3>🔧 Service Configuration</h3>
            <button class="btn" onclick="testConfiguration()">Test Configuration</button>
            <button class="btn btn-secondary" onclick="getConfiguration()">Get Configuration</button>
            <div id="config-result" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>📧 Single Email Test</h3>
            <div class="form-group">
                <label for="email-to">To:</label>
                <input type="email" id="email-to" placeholder="recipient@example.com" value="test@example.com">
            </div>
            <div class="form-group">
                <label for="email-subject">Subject:</label>
                <input type="text" id="email-subject" placeholder="Email subject" value="Test Email">
            </div>
            <div class="form-group">
                <label for="email-body">Body:</label>
                <textarea id="email-body" placeholder="Email body">Bu bir test email'idir. Email/SMS service çalışıyor!</textarea>
            </div>
            <button class="btn" onclick="sendSingleEmail()">Send Email</button>
            <div id="email-result" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>📱 Single SMS Test</h3>
            <div class="form-group">
                <label for="sms-to">Phone Number:</label>
                <input type="tel" id="sms-to" placeholder="+905551234567" value="+905551234567">
            </div>
            <div class="form-group">
                <label for="sms-message">Message:</label>
                <textarea id="sms-message" placeholder="SMS message">Bu bir test SMS'idir. Email/SMS service çalışıyor!</textarea>
            </div>
            <button class="btn" onclick="sendSingleSMS()">Send SMS</button>
            <div id="sms-result" class="result" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>📧 Email with Template</h3>
            <div class="form-group">
                <label>Select Template:</label>
                <div class="template-selector">
                    <div class="template-card" onclick="selectTemplate('welcome-member')">
                        <h4>Hoş Geldiniz</h4>
                        <p>Yeni üye hoş geldin mesajı</p>
                        <div class="variables">
                            <h5>Variables:</h5>
                            <div>name: <input type="text" id="template-name" placeholder="İsim" value="Ahmet Yılmaz"></div>
                        </div>
                    </div>
                    <div class="template-card" onclick="selectTemplate('donation-receipt')">
                        <h4>Bağış Makbuzu</h4>
                        <p>Bağış makbuzu mesajı</p>
                        <div class="variables">
                            <h5>Variables:</h5>
                            <div>name: <input type="text" id="template-donor-name" placeholder="Bağışçı adı" value="Mehmet Kaya"></div>
                            <div>amount: <input type="number" id="template-amount" placeholder="Miktar" value="500"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="template-to">To:</label>
                <input type="email" id="template-to" placeholder="recipient@example.com" value="test@example.com">
            </div>
            <button class="btn" onclick="sendTemplateEmail()">Send Template Email</button>
            <div id="template-result" class="result" style="display: none;"></div>
        </div>

        <div class="test-section bulk-section">
            <h3>📧 Bulk Email Test</h3>
            <div class="form-group">
                <label for="bulk-recipients">Recipients (one per line):</label>
                <textarea id="bulk-recipients" placeholder="recipient1@example.com&#10;recipient2@example.com&#10;recipient3@example.com">test1@example.com
test2@example.com
test3@example.com</textarea>
            </div>
            <div class="form-group">
                <label for="bulk-email-subject">Subject:</label>
                <input type="text" id="bulk-email-subject" placeholder="Bulk email subject" value="Toplu Email Test">
            </div>
            <div class="form-group">
                <label for="bulk-email-body">Body:</label>
                <textarea id="bulk-email-body" placeholder="Bulk email body">Bu bir toplu email test'idir. Tüm alıcılara gönderilecek.</textarea>
            </div>
            <button class="btn" onclick="sendBulkEmail()">Send Bulk Email</button>
            <div id="bulk-email-result" class="result" style="display: none;"></div>
        </div>

        <div class="test-section bulk-section">
            <h3>📱 Bulk SMS Test</h3>
            <div class="form-group">
                <label for="bulk-sms-recipients">Phone Numbers (one per line):</label>
                <textarea id="bulk-sms-recipients" placeholder="+905551234567&#10;+905559876543&#10;+905555556666">+905551234567
+905559876543
+905555556666</textarea>
            </div>
            <div class="form-group">
                <label for="bulk-sms-message">Message:</label>
                <textarea id="bulk-sms-message" placeholder="Bulk SMS message">Bu bir toplu SMS test'idir. Tüm numaralara gönderilecek.</textarea>
            </div>
            <button class="btn" onclick="sendBulkSMS()">Send Bulk SMS</button>
            <div id="bulk-sms-result" class="result" style="display: none;"></div>
        </div>
    </div>

    <script>
        let selectedTemplate = 'welcome-member';

        function selectTemplate(templateId) {
            selectedTemplate = templateId;
            document.querySelectorAll('.template-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.target.closest('.template-card').classList.add('selected');
        }

        function showResult(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            element.className = `result ${type}`;
            element.innerHTML = message;
            element.style.display = 'block';
        }

        async function testConfiguration() {
            showResult('config-result', '🔄 Configuration test ediliyor...', 'info');
            
            try {
                // Mock implementation - gerçek uygulamada API call yapılacak
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                const config = {
                    provider: 'appwrite-messaging',
                    endpoint: 'https://fra.cloud.appwrite.io/v1',
                    projectId: '68e99f6c000183bafb39',
                    initialized: true
                };
                
                showResult('config-result', 
                    `✅ Configuration test başarılı!<br>
                    <strong>Provider:</strong> ${config.provider}<br>
                    <strong>Endpoint:</strong> ${config.endpoint}<br>
                    <strong>Project ID:</strong> ${config.projectId}<br>
                    <strong>Initialized:</strong> ${config.initialized}`, 
                    'success');
            } catch (error) {
                showResult('config-result', `❌ Configuration test başarısız: ${error.message}`, 'error');
            }
        }

        async function getConfiguration() {
            try {
                const config = {
                    provider: 'appwrite-messaging',
                    endpoint: 'https://fra.cloud.appwrite.io/v1',
                    projectId: '68e99f6c000183bafb39',
                    initialized: true
                };
                
                showResult('config-result', 
                    `<strong>Configuration:</strong><br>
                    <pre>${JSON.stringify(config, null, 2)}</pre>`, 
                    'info');
            } catch (error) {
                showResult('config-result', `❌ Configuration alınamadı: ${error.message}`, 'error');
            }
        }

        async function sendSingleEmail() {
            const to = document.getElementById('email-to').value;
            const subject = document.getElementById('email-subject').value;
            const body = document.getElementById('email-body').value;
            
            showResult('email-result', '🔄 Email gönderiliyor...', 'info');
            
            try {
                // Mock implementation - gerçek uygulamada API call yapılacak
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                showResult('email-result', 
                    `✅ Email başarıyla gönderildi!<br>
                    <strong>To:</strong> ${to}<br>
                    <strong>Subject:</strong> ${subject}<br>
                    <strong>Body:</strong> ${body.substring(0, 100)}...`, 
                    'success');
            } catch (error) {
                showResult('email-result', `❌ Email gönderilemedi: ${error.message}`, 'error');
            }
        }

        async function sendSingleSMS() {
            const to = document.getElementById('sms-to').value;
            const message = document.getElementById('sms-message').value;
            
            showResult('sms-result', '🔄 SMS gönderiliyor...', 'info');
            
            try {
                // Mock implementation - gerçek uygulamada API call yapılacak
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                showResult('sms-result', 
                    `✅ SMS başarıyla gönderildi!<br>
                    <strong>To:</strong> ${to}<br>
                    <strong>Message:</strong> ${message}`, 
                    'success');
            } catch (error) {
                showResult('sms-result', `❌ SMS gönderilemedi: ${error.message}`, 'error');
            }
        }

        async function sendTemplateEmail() {
            const to = document.getElementById('template-to').value;
            
            showResult('template-result', '🔄 Template email gönderiliyor...', 'info');
            
            try {
                let subject, body;
                
                if (selectedTemplate === 'welcome-member') {
                    const name = document.getElementById('template-name').value;
                    subject = 'Hoş Geldiniz';
                    body = `Merhaba ${name}, derneğimize hoş geldiniz!`;
                } else if (selectedTemplate === 'donation-receipt') {
                    const donorName = document.getElementById('template-donor-name').value;
                    const amount = document.getElementById('template-amount').value;
                    subject = 'Bağış Makbuzu';
                    body = `${donorName} adına ${amount} TL bağış alınmıştır.`;
                }
                
                // Mock implementation - gerçek uygulamada API call yapılacak
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                showResult('template-result', 
                    `✅ Template email başarıyla gönderildi!<br>
                    <strong>Template:</strong> ${selectedTemplate}<br>
                    <strong>To:</strong> ${to}<br>
                    <strong>Subject:</strong> ${subject}<br>
                    <strong>Body:</strong> ${body}`, 
                    'success');
            } catch (error) {
                showResult('template-result', `❌ Template email gönderilemedi: ${error.message}`, 'error');
            }
        }

        async function sendBulkEmail() {
            const recipientsText = document.getElementById('bulk-recipients').value;
            const recipients = recipientsText.split('\n').filter(email => email.trim());
            const subject = document.getElementById('bulk-email-subject').value;
            const body = document.getElementById('bulk-email-body').value;
            
            showResult('bulk-email-result', `🔄 ${recipients.length} alıcıya toplu email gönderiliyor...`, 'info');
            
            try {
                // Mock implementation - gerçek uygulamada API call yapılacak
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                showResult('bulk-email-result', 
                    `✅ Toplu email başarıyla gönderildi!<br>
                    <strong>Sent:</strong> ${recipients.length}<br>
                    <strong>Failed:</strong> 0<br>
                    <strong>Subject:</strong> ${subject}<br>
                    <strong>Recipients:</strong> ${recipients.join(', ')}`, 
                    'success');
            } catch (error) {
                showResult('bulk-email-result', `❌ Toplu email gönderilemedi: ${error.message}`, 'error');
            }
        }

        async function sendBulkSMS() {
            const recipientsText = document.getElementById('bulk-sms-recipients').value;
            const recipients = recipientsText.split('\n').filter(phone => phone.trim());
            const message = document.getElementById('bulk-sms-message').value;
            
            showResult('bulk-sms-result', `🔄 ${recipients.length} numaraya toplu SMS gönderiliyor...`, 'info');
            
            try {
                // Mock implementation - gerçek uygulamada API call yapılacak
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                showResult('bulk-sms-result', 
                    `✅ Toplu SMS başarıyla gönderildi!<br>
                    <strong>Sent:</strong> ${recipients.length}<br>
                    <strong>Failed:</strong> 0<br>
                    <strong>Message:</strong> ${message}<br>
                    <strong>Recipients:</strong> ${recipients.join(', ')}`, 
                    'success');
            } catch (error) {
                showResult('bulk-sms-result', `❌ Toplu SMS gönderilemedi: ${error.message}`, 'error');
            }
        }

        // Initialize template selection
        document.addEventListener('DOMContentLoaded', function() {
            selectTemplate('welcome-member');
        });
    </script>
</body>
</html>
